<?xml version="1.0"?>
<!--文件说明 ： 凭证接口相关配置信息                  -->
<!--    作者 ： 徐芳波                               -->
<!--    日期 ： 2010-6-5                             -->
<!--    说明 ： 更多信息请参考凭证接口设计文档和代码   -->
<DocSourceVoucher>
  <Modle Name="CS">
    <Runtimes>
      <Runtime Name="Ufida.T.SM.FC"/>
      <Runtime Name="Ufida.T.CS.DTO"/>
      <Runtime Name="Ufida.T.UA.CS"/>
    </Runtimes>
    <Voucher Code="CS01" Name="BankCashAccessVoucherDTO"  Title="银行存取款单">
      <SimpleQuery Title="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">

        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
        <Fields>
          <Property Name="ID" MapProperty="NEWID()" Title="Id" />
          <Property Name="UserId" MapProperty="{UserId}" Title="UserId" />
          <Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型" />
          <Property Name="VoucherId" MapProperty="BankCashAccessVoucherDTO.ID" Title="单据Id" />
          <Property Name="VoucherDate" MapProperty="BankCashAccessVoucherDTO.VoucherDate" Titile="单据日期"/>
          <Property Name="VoucherCode" MapProperty="BankCashAccessVoucherDTO.Code" Titile="单据编号"/>
          <Property Name="VoucherTs" MapProperty="BankCashAccessVoucherDTO.Ts" Title="单据时间戳"/>
          <Property Name="IdbusiType" MapProperty="BankCashAccessVoucherDTO.idbusinessType" Titile="业务类型"/>
          <Property Name="Idcurrency" MapProperty="BankCashAccessVoucherDTO.OutBankAccount.idCurrency" Titile="币种"/>
          <Property Name="IdbankAccount" MapProperty="BankCashAccessVoucherDTO.idOutBankAccount"  Titile="账号"/>
          <Property Name="Idclerck" MapProperty="BankCashAccessVoucherDTO.idhandler" Titile="员工"/>
			<Property Name="OrigAmount" MapProperty="BankCashAccessVoucherDTO.OrigOutAmount" Titile="金额"/>
			<Property Name="Amount" MapProperty="BankCashAccessVoucherDTO.OutAmount" Titile="本币金额"/>
        </Fields>

        <PropertyFilters>
          <Filter Name="VoucherDate" MapProperty="BankCashAccessVoucherDTO.VoucherDate"/>
          <Filter Name="VoucherCode" MapProperty="BankCashAccessVoucherDTO.Code"/>
          <!--<Filter Name="SupplierCode" MapProperty=""/>
          <Filter Name="CustomerCode" MapProperty=""/>
          <Filter Name="Departments" MapProperty=""/>-->
          <Filter Name="Persons" MapProperty="BankCashAccessVoucherDTO.idhandler"/>
          <!--<Filter Name="Projects" MapProperty=""/>-->
          <Filter Name="Bankaccounts" MapProperty="BankCashAccessVoucherDTO.idOutBankAccount"/>
          <Filter Name="Currencys" MapProperty="BankCashAccessVoucherDTO.OutBankAccount.idCurrency"/>
          <Filter Name="OrigAmount" MapProperty="BankCashAccessVoucherDTO.OrigOutAmount" />
          <Filter Name="Amount" MapProperty="BankCashAccessVoucherDTO.OutAmount" />
		      <Filter Name="maker" MapProperty="BankCashAccessVoucherDTO.makerid"/> 
          <Filter Name="auditor" MapProperty="BankCashAccessVoucherDTO.auditorid"/> 
        </PropertyFilters>

        <!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
        <BusinessFilters ModeName="CashBankMoneyFlow">
          <Filter Name="未生效的不生成">
            BankCashAccessVoucherDTO.VoucherState={VoucherState.Effective}
          </Filter>
          <Filter Name="已生成凭证的业务单据不生成">
            (BankCashAccessVoucherDTO.DocId IS NULL or BankCashAccessVoucherDTO.DocId='')
          </Filter>
          <Filter Name="该模块启用期间之前的期初单据不生成">
            BankCashAccessVoucherDTO.VoucherDate>={ModelOpeningDate}
          </Filter>
			<Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
				BankCashAccessVoucherDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
			</Filter>
        </BusinessFilters>
      </SimpleQuery>
      <FullQuery Name="完整查询设置" Type="Ufida.T.SM.FC.AbstractFullQuery">
        <Header>
          <Property Name="BankCashAccessVoucherDTO.ID"  Title="单据ID"/>
          <Property Name="BankCashAccessVoucherDTO.TS"  Title="TS"/>
          <Property Name="BankCashAccessVoucherDTO.idbusinessType"  Title="业务类型ID"/>
          <Property Name="BankCashAccessVoucherDTO.BusinessType.ID"  Title="业务类型"/>
          <Property Name="BankCashAccessVoucherDTO.BusinessType.Name"  Title="业务类型"/>
          <Property Name="BankCashAccessVoucherDTO.VoucherDate"  Title="单据日期"/>
          <Property Name="BankCashAccessVoucherDTO.Code"  Title="单据编号"/>
          <Property Name="BankCashAccessVoucherDTO.Memo"  Title="备注"/>
          <Property Name="BankCashAccessVoucherDTO.OrigOutAmount"  Title="转出金额"/>
          <Property Name="BankCashAccessVoucherDTO.OrigInAmount"  Title="转入金额"/>
          <Property Name="BankCashAccessVoucherDTO.OutAmount"  Title="转出金额本币"/>
          <Property Name="BankCashAccessVoucherDTO.InAmount"  Title="转入金额本币"/>
          <Property Name="BankCashAccessVoucherDTO.OutExchangeRate"  Title="转出汇率"/>
          <Property Name="BankCashAccessVoucherDTO.InExchangeRate"  Title="转入汇率"/>
          <Property Name="BankCashAccessVoucherDTO.Difference"  Title="差异"/>
          <Property Name="BankCashAccessVoucherDTO.IdoutBankAccount"  Title="转出账号ID"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.ID"  Title="转出账号"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.Name"  Title="转出账号名称"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.BankNoType.ID"  Title="转出账号类型id"/>
          <Property Name="BankCashAccessVoucherDTO.IdinBankAccount"  Title="转入账号ID"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.ID"  Title="转入账号"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.Name"  Title="转入账号名称"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.BankNoType.ID"  Title="转出账号类型id"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.idCurrency"  Title="转出币种ID"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.Currency.ID"  Title="转出币种"/>
          <Property Name="BankCashAccessVoucherDTO.OutBankAccount.Currency.Name"  Title="转出币种名称"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.idCurrency"  Title="转入币种ID"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.Currency.ID"  Title="转入币种"/>
          <Property Name="BankCashAccessVoucherDTO.InBankAccount.Currency.Name"  Title="转入币种名称"/>
          <Property Name="BankCashAccessVoucherDTO.Idhandler"  Title="人员ID"/>
          <Property Name="BankCashAccessVoucherDTO.Handler.ID"  Title="人员"/>
          <Property Name="BankCashAccessVoucherDTO.Handler.Code"  Title="人员编码"/>
          <Property Name="BankCashAccessVoucherDTO.Handler.Name"  Title="人员名称"/>
          <Property Name="BankCashAccessVoucherDTO.idInProject"  Title="转入项目D"/>
          <Property Name="BankCashAccessVoucherDTO.InProject.ID"  Title="转入项目"/>
          <Property Name="BankCashAccessVoucherDTO.InProject.Name"  Title="转入项目名称"/>
          <Property Name="BankCashAccessVoucherDTO.idOutProject"  Title="转出项目ID"/>
          <Property Name="BankCashAccessVoucherDTO.OutProject.ID"  Title="转出项目"/>
          <Property Name="BankCashAccessVoucherDTO.OutProject.Name"  Title="转出项目名称"/>
          <Property Name="BankCashAccessVoucherDTO.idInDepartment"  Title="转入部门D"/>
          <Property Name="BankCashAccessVoucherDTO.InDepartment.ID"  Title="转入部门"/>
          <Property Name="BankCashAccessVoucherDTO.InDepartment.Name"  Title="转入部门名称"/>
          <Property Name="BankCashAccessVoucherDTO.idOutDepartment"  Title="转出部门ID"/>
          <Property Name="BankCashAccessVoucherDTO.OutDepartment.ID"  Title="转出部门"/>
          <Property Name="BankCashAccessVoucherDTO.OutDepartment.Name"  Title="转出部门名称"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm6"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm1"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm2"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm3"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm4"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefdecm5"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc6"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc1"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc2"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc3"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc4"/>
          <Property Name="BankCashAccessVoucherDTO.pubuserdefnvc5"/>
        </Header>
      </FullQuery>
      <TransactionDoc Type="Ufida.T.UA.CS.FC.BankCashAccessVoucher">
        <SummaryFields>
          <Property Name="VoucherTypeId" Mapping="ID" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="idbusinessType" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="BusinessType.Name" Title="业务类型"/>
          <Property Name="Partner" Mapping="" Title="往来单位"/>
          <Property Name="Department" Mapping="" Title="部门"/>
          <Property Name="Person" Mapping="Handler.Name" Title="人员"/>
          <Property Name="Memo" Mapping="Memo" Title="备注"/>
        </SummaryFields>
        <TransactionEntry Code="DebitFromIn" Name="转入生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="InAmount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigInAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigInAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="InBankAccount.idCurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="InExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdinBankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="InBankAccount.Idcurrency"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idInDepartment"/>
			  <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idInProject"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdinBankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="InBankAccount.Idcurrency"/>

              <!--11.31-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idInDepartment"/>
			  <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idInProject"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idhandler"/>
            <Property Doc="Idcurrency" SourceVoucher="InBankAccount.Idcurrency"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdinBankAccount"/>
            <Property Doc="idbusiType" SourceVoucher="idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>

            <!--11.31-->
            <Property Doc="Iddepartment" SourceVoucher="idInDepartment"/>
			<Property Doc="Idproject" SourceVoucher="idInProject"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="DebitFromDifference" Name="差异生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="Difference"/>
            <Property Doc="OrigAmountDr" SourceVoucher="Difference"/>
            <Property Doc="OrigAmount" SourceVoucher="Difference"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
          </Entry>
          <Account AccountRuleType="PendingAccount">
            <ExtendRuleProperty Name="Idvouchertype" SourceVoucherProperty="{IdvoucherType}"/>
            <ExtendRuleProperty Name="Idbusitype" SourceVoucherProperty="idbusinessType"/>
          </Account>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idhandler"/>
            <Property Doc="idbusiType" SourceVoucher="idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromOut" Name="转出生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="OutAmount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigOutAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigOutAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="OutBankAccount.idCurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="OutExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdoutBankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="OutBankAccount.Idcurrency"/>

              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idOutDepartment"/>
			  <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idOutProject"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdoutBankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="OutBankAccount.Idcurrency"/>

              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idOutDepartment"/>
			  <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idOutProject"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idhandler"/>
            <Property Doc="Idcurrency" SourceVoucher="OutBankAccount.Idcurrency"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdoutBankAccount"/>
            <Property Doc="idbusiType" SourceVoucher="idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31-->
            <Property Doc="Iddepartment" SourceVoucher="idOutDepartment"/>
			<Property Doc="Idproject" SourceVoucher="idOutProject"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
      </TransactionDoc>
      <DocUpdateBack Title="回写" Type="Ufida.T.UA.CS.FC.DocUpdateBackBankCashAccessVoucher" />
    </Voucher>
    
	<Voucher Code="CS02" Name="ExpenseVoucherDTO"  Title="费用单">	
      <SimpleQuery Title="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">

        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
        <Fields>
          <Property Name="ID" MapProperty="NEWID()" Title="Id" />
          <Property Name="UserId" MapProperty="{UserId}" Title="UserId" />
          <Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型" />
          <Property Name="VoucherId" MapProperty="ExpenseVoucherDTO.ID" Title="单据Id" />
          <Property Name="VoucherDate" MapProperty="ExpenseVoucherDTO.VoucherDate" Titile="单据日期"/>
          <Property Name="VoucherCode" MapProperty="ExpenseVoucherDTO.Code" Titile="单据编号"/>
          <Property Name="VoucherTs" MapProperty="ExpenseVoucherDTO.Ts" Title="单据时间戳"/>
          <Property Name="IdbusiType" MapProperty="ExpenseVoucherDTO.idbusinessType" Titile="业务类型"/>
          <Property Name="Idcurrency" MapProperty="ExpenseVoucherDTO.idcurrency" Titile="币种"/>
		  <Property Name="IdbankAccount" MapProperty="ExpenseVoucherDTO.MultiSettles.idbankAccount"  Titile="账号"/>
          <Property Name="Idclerck" MapProperty="ExpenseVoucherDTO.idclerk" Titile="员工"/>
          <Property Name="Iddepartment" MapProperty="ExpenseVoucherDTO.iddepartment" Titile="部门"/>
          <Property Name="Idsupplier" MapProperty="ExpenseVoucherDTO.idpartner" Titile="供应商"/>
          <!--合并往来单位-->
          <Property Name="Idcustomer" MapProperty="ExpenseVoucherDTO.idpartner" Titile="客户"/>
          <Property Name="Idproject" MapProperty="ExpenseVoucherDTO.idproject" Title="项目"/>
          <Property Name="OrigAmount" MapProperty="ExpenseVoucherDTO.origTaxAmountSum" Title="金额"/>
          <Property Name="Amount" MapProperty="ExpenseVoucherDTO.taxAmountSum" Title="本币金额"/>
        </Fields>

        <PropertyFilters>
          <Filter Name="VoucherDate" MapProperty="ExpenseVoucherDTO.VoucherDate"/>
          <Filter Name="VoucherCode" MapProperty="ExpenseVoucherDTO.Code"/>
          <!--<Filter Name="SupplierCode" MapProperty="ExpenseVoucherDTO.Partner.Code"/>-->
          <!--合并往来单位-->
          <Filter Name="CustomerCode" MapProperty="ExpenseVoucherDTO.Partner.Code"/>
          <Filter Name="Departments" MapProperty="ExpenseVoucherDTO.iddepartment"/>
          <Filter Name="Persons" MapProperty="ExpenseVoucherDTO.idclerk"/>

          <!--XXdp202025479,Shicz1,2012-05-03-->
          <!--<Filter Name="Projects" MapProperty="ExpenseVoucherDTO.idproject"/>-->
          <Filter Name="Currencys" MapProperty="ExpenseVoucherDTO.idcurrency"/>

          <Filter Name="PartnerClass" MapProperty="ExpenseVoucherDTO.Partner.idpartnerclass"/>
          <!--XXdp202025479,Shicz1,2012-05-03-->
          <!--<Filter Name="ProjectClass" MapProperty="ExpenseVoucherDTO.project.idclass"/>-->
            
            <!--XXdp202025479,Shicz1,2012-05-03-->
            <Filter Name="ProjectClass" MapProperty="ExpenseVoucherDTO.Details.project.idclass"/>
            <Filter Name="Projects" MapProperty="ExpenseVoucherDTO.Details.idproject"/>

          <Filter Name="OrigAmount" MapProperty="ExpenseVoucherDTO.origTaxAmountSum" />
          <Filter Name="Amount" MapProperty="ExpenseVoucherDTO.taxAmountSum" />
		  <Filter Name="ExpenseItem" MapProperty="ExpenseVoucherDTO.Details.idexpenseItem" />
		  <Filter Name="Bankaccounts" MapProperty="ExpenseVoucherDTO.MultiSettles.idbankAccount"/>
          <Filter Name="maker" MapProperty="ExpenseVoucherDTO.makerid"/>
          <Filter Name="auditor" MapProperty="ExpenseVoucherDTO.auditorid"/>
		</PropertyFilters>

        <!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
        <BusinessFilters ModeName="CashBankMoneyFlow">
          <Filter Name="未生效的不生成">
            ExpenseVoucherDTO.VoucherState={VoucherState.Effective}
          </Filter>
          <Filter Name="已生成凭证的业务单据不生成">
            (ExpenseVoucherDTO.DocId IS NULL or ExpenseVoucherDTO.DocId='')
          </Filter>
          <Filter Name="该模块启用期间之前的期初单据不生成">
            ExpenseVoucherDTO.VoucherDate>={ModelOpeningDate}
          </Filter>
			<Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
				ExpenseVoucherDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
			</Filter>
        </BusinessFilters>
      </SimpleQuery>
      <FullQuery Name="完整查询设置" Type="Ufida.T.SM.FC.AbstractFullQuery">
        <Header>
          <Property Name="ExpenseVoucherDTO.ID"  Title="单据ID"/>
          <Property Name="ExpenseVoucherDTO.TS"  Title="TS"/>
          <Property Name="ExpenseVoucherDTO.idbusinessType"  Title="业务类型ID"/>
          <Property Name="ExpenseVoucherDTO.BusinessType.ID"  Title="业务类型ID"/>
          <Property Name="ExpenseVoucherDTO.BusinessType.Name"  Title="业务类型"/>
          <Property Name="ExpenseVoucherDTO.VoucherDate"  Title="单据日期"/>
          <Property Name="ExpenseVoucherDTO.Code"  Title="单据编号"/>
          <Property Name="ExpenseVoucherDTO.Memo"  Title="备注"/>
          <Property Name="ExpenseVoucherDTO.PaymentAmount"  Title="使用预付本币"/>
          <Property Name="ExpenseVoucherDTO.OrigPaymentAmount"  Title="使用预付"/>
          <Property Name="ExpenseVoucherDTO.TaxAmountSum"  Title="含税金额本币合计"/>
          <Property Name="ExpenseVoucherDTO.OrigTaxAmountSum"  Title="含税金额合计"/>
          <Property Name="ExpenseVoucherDTO.Amount"  Title="现结金额合计（本币）"/>
          <Property Name="ExpenseVoucherDTO.OrigAmount"  Title="现结金额合计"/>
          <Property Name="ExpenseVoucherDTO.idCurrency"  Title="币种ID"/>
          <Property Name="ExpenseVoucherDTO.Currency.ID"  Title="币种"/>
          <Property Name="ExpenseVoucherDTO.Currency.Name"  Title="币种名称"/>
          <Property Name="ExpenseVoucherDTO.ExchangeRate"  Title="汇率"/>
          <Property Name="ExpenseVoucherDTO.idDepartment"  Title="部门ID"/>
          <Property Name="ExpenseVoucherDTO.Department.ID"  Title="部门"/>
          <Property Name="ExpenseVoucherDTO.Department.Code"  Title="部门编码"/>
          <Property Name="ExpenseVoucherDTO.Department.Name"  Title="部门名称"/>
          <Property Name="ExpenseVoucherDTO.Idclerk"  Title="人员ID"/>
          <Property Name="ExpenseVoucherDTO.Clerk.ID"  Title="人员"/>
          <Property Name="ExpenseVoucherDTO.Clerk.Code"  Title="人员编码"/>
          <Property Name="ExpenseVoucherDTO.Clerk.Name"  Title="人员名称"/>
          <Property Name="ExpenseVoucherDTO.idPartner"  Title="供应商ID"/>
          <Property Name="ExpenseVoucherDTO.Partner.ID"  Title="供应商"/>
          <Property Name="ExpenseVoucherDTO.Partner.Code"  Title="供应商编码"/>
          <Property Name="ExpenseVoucherDTO.Partner.Name"  Title="供应商名称"/>
		  <Property Name="ExpenseVoucherDTO.ARAPAccountDirection.ID"  Title="记账方向ID"/>
          <Property Name="ExpenseVoucherDTO.ARAPAccountDirection.Code"  Title="记账方向编码"/>
          <Property Name="ExpenseVoucherDTO.ARAPAccountDirection.Name"  Title="记账方向名称"/>
          <Property Name="ExpenseVoucherDTO.Partner.IdpartnerClass"  Title="往来单位分类id"/>
          <Property Name="ExpenseVoucherDTO.Partner.PartnerClass.ID"  Title="往来单位分类"/>
          <Property Name="ExpenseVoucherDTO.Partner.PartnerClass.Name"  Title="往来单位名称"/>
          <Property Name="ExpenseVoucherDTO.idProject"  Title="项目ID"/>
          <Property Name="ExpenseVoucherDTO.Project.ID"  Title="项目"/>
          <Property Name="ExpenseVoucherDTO.Project.Name"  Title="项目名称"/>

          <Property Name="ExpenseVoucherDTO.Partner.Iddistrict"  Title="地区ID"/>
          <Property Name="ExpenseVoucherDTO.Partner.District.ID"  Title="地区"/>
          <Property Name="ExpenseVoucherDTO.Partner.District.Name"  Title="地区名称"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm6"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm1"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm2"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm3"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm4"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefdecm5"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc6"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc1"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc2"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc3"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc4"/>
          <Property Name="ExpenseVoucherDTO.pubuserdefnvc5"/>
        </Header>
        <Details>
          <Detail DetailRuleName="MultiSettles" DTO="ExpenseVoucherMultiSettleDTO" FK="IdexpenseVoucherDTO" Title="现结明细">
            <Property Name="ExpenseVoucherMultiSettleDTO.ID"  Title="ID"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.TS"  Title="TS"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.idSettleStyle"  Title="结算方式id"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.SettleStyle.ID"  Title="结算方式"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.idBankAccount"  Title="账号id"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.ID"  Title="账号"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.BankNoType.ID"  Title="账号类型id"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.Idcurrency"  Title="账号币种id"/>
			
			<!-- begin: 添加部门 -->
		   <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.Department.ID"  Title="部门id"/>
		   <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.Department.Code"  Title="部门code"/>
		   <Property Name="ExpenseVoucherMultiSettleDTO.BankAccount.Department.Name"  Title="部门name"/>
			<!-- end: 添加部门 -->
						
            <Property Name="ExpenseVoucherMultiSettleDTO.DocumentCode"  Title="票据号"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.Amount"  Title="付款金额本币"/>
            <Property Name="ExpenseVoucherMultiSettleDTO.OrigAmount"  Title="付款金额"/>
          </Detail>
          <Detail DetailRuleName="Details" DTO="ExpenseVoucherDetailDTO" FK="IdexpenseVoucherDTO" Title="明细">
            <Property Name="ExpenseVoucherDetailDTO.ID"  Title="ID"/>
            <Property Name="ExpenseVoucherDetailDTO.TS"  Title="TS"/>
            <Property Name="ExpenseVoucherDetailDTO.OrigAmount"  Title="金额"/>
            <Property Name="ExpenseVoucherDetailDTO.Amount"  Title="本币金额"/>
            <Property Name="ExpenseVoucherDetailDTO.OrigTax"  Title="税额"/>
            <Property Name="ExpenseVoucherDetailDTO.Tax"  Title="本币税额"/>
            <Property Name="ExpenseVoucherDetailDTO.OrigTaxAmount"  Title="含税金额"/>
            <Property Name="ExpenseVoucherDetailDTO.TaxAmount"  Title="本币含税金额"/>
            <Property Name="ExpenseVoucherDetailDTO.OrigSettleAmount"  Title="累计结算金额"/>
            <Property Name="ExpenseVoucherDetailDTO.SettleAmount"  Title="累计结算金额本币"/>
            <Property Name="ExpenseVoucherDetailDTO.idexpenseItem"  Title="费用id"/>
            <Property Name="ExpenseVoucherDetailDTO.ExpenseItem.ID"  Title="费用"/>
            <Property Name="ExpenseVoucherDetailDTO.ExpenseItem.ExpenseType.ID"  Title="费用类型"/>
            <Property Name="ExpenseVoucherDetailDTO.ExpenseItem.ExpenseType.Code"  Title="费用类型编码"/>
            <Property Name="ExpenseVoucherDetailDTO.ExpenseItem.ApportionFlag"  Title="是否分摊"/>
            <Property Name="ExpenseVoucherDetailDTO.idProject"  Title="项目ID"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.ID"  Title="项目"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.Name"  Title="项目名称"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.IdClass"  Title="项目分类"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.Class.ID"  Title="项目分类"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.Class.Name"  Title="项目分类"/>
            <Property Name="ExpenseVoucherDetailDTO.Project.Class.Code"  Title="项目分类"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefdecm4"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefdecm1"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefdecm2"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefdecm3"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefnvc4"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefnvc1"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefnvc2"/>
            <Property Name="ExpenseVoucherDetailDTO.pubuserdefnvc3"/>
          </Detail>
        </Details>
      </FullQuery>
      <TransactionDoc Type="Ufida.T.UA.CS.FC.ExpenseVoucher">
        <SummaryFields>
          <Property Name="VoucherTypeId" Mapping="ID" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="idbusinessType" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="BusinessType.Name" Title="业务类型"/>
          <Property Name="Partner" Mapping="Partner.Name" Title="往来单位"/>
          <Property Name="Department" Mapping="Department.Name" Title="部门"/>
          <Property Name="Person" Mapping="Clerk.Name" Title="人员"/>
          <Property Name="Memo" Mapping="Memo" Title="备注"/>
        </SummaryFields>
        <TransactionEntry Code="DebitFromExpense" Name="明细金额生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="Amount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExpenseVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="ExpenseVoucher.Memo"/>
            <Account AccountRuleType="PurchaseExpense">
			  <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="ExpenseVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="ExpenseVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="Idproject"/>
              <ExtendRuleProperty Name="IdexpenseItem" SourceVoucherProperty="IdexpenseItem"/>
              <ExtendRuleProperty Name="idProjectClass" SourceVoucherProperty="Project.IdClass"/>
            </Account>
            <Account AccountRuleType="Expense">
              <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="ExpenseVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="ExpenseVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="Idproject"/>
              <ExtendRuleProperty Name="IdexpenseItem" SourceVoucherProperty="IdexpenseItem"/>
              <ExtendRuleProperty Name="ExpenseType" SourceVoucherProperty="ExpenseItem.ExpenseType.ID"/>

              <!--11.31-->

              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>

            </Account>
          </Entry>
          <Auxiliary>
            <!--<Property Doc="Idsupplier" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdsupplierClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>
            
              <Property Doc="Idcustomer" SourceVoucher="Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="Partner.IdpartnerClass"/>
            -->
            <!--11.31 统一了往来单位-->
            <Property Doc="Idcustomer" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>

            <Property Doc="Iddistrict" SourceVoucher="ExpenseVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="ExpenseVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="ExpenseVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="ExpenseVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="ExpenseVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="ExpenseVoucher.VoucherDate"/>
            <Property Doc="IdexpenseItem" SourceVoucher="IdexpenseItem"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ExpenseVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="ExpenseVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="DebitFromTaxAmount" Name="税金生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="Tax"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigTax"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigTax"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExpenseVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="ExpenseVoucher.Memo"/>
            <Account AccountRuleType="ArrivalTax">
              <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="ExpenseVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="ExpenseVoucher.Idpartner"/>
            </Account>
          </Entry>
          <Auxiliary>
            <!--11.31统一修改为往来单位-->
            <Property Doc="Idcustomer" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>

            <Property Doc="Iddistrict" SourceVoucher="ExpenseVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="ExpenseVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="ExpenseVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="ExpenseVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="ExpenseVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="ExpenseVoucher.VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ExpenseVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="ExpenseVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromAr" Name="应收生成贷方" DCDirection="Credit">
		  <Entry>
            <Property Doc="AmountCr" SourceVoucher="TaxAmount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigTaxAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>            
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExpenseVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="ExpenseVoucher.Memo"/>
            <Account AccountRuleType="OtherAr">			  
			  <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="ExpenseVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="ExpenseVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddistrict" SourceVoucherProperty="ExpenseVoucher.Partner.Iddistrict"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="ExpenseVoucher.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="ExpenseVoucher.idProject"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
          </Entry>
          <Auxiliary>
            <!--11.31 统一了往来单位-->
            <Property Doc="Idcustomer" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>

            <Property Doc="Iddistrict" SourceVoucher="ExpenseVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="ExpenseVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="ExpenseVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="ExpenseVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="ExpenseVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="ExpenseVoucher.VoucherDate"/>
            <Property Doc="IdexpenseItem" SourceVoucher="IdexpenseItem"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ExpenseVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="ExpenseVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
		<TransactionEntry Code="CreditFromAp" Name="应付生成贷方" DCDirection="Credit">
          <Entry>
            <!-- 按照明细修改11。3-->
            <Property Doc="AmountCr" SourceVoucher="TaxAmount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigTaxAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>

            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExpenseVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="ExpenseVoucher.Memo"/>
            <Account AccountRuleType="OtherAp">
              <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="ExpenseVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="ExpenseVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddistrict" SourceVoucherProperty="ExpenseVoucher.Partner.Iddistrict"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="ExpenseVoucher.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="ExpenseVoucher.idProject"/>
              <!--<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>-->
              <!--11.31//11.3修改了-->

              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
          </Entry>
          <Auxiliary>
            <!--11.31统一往来单位-->
            <Property Doc="Idcustomer" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>

            <Property Doc="Iddistrict" SourceVoucher="ExpenseVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="ExpenseVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="ExpenseVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="ExpenseVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="ExpenseVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="ExpenseVoucher.VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <!--<Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>-->
            <Property Doc="SourceVoucherId" SourceVoucher="ExpenseVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="ExpenseVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromCash" Name="现结生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="Amount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExpenseVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="ExpenseVoucher.Memo"/>
            <Property Doc="BillNo" SourceVoucher="DocumentCode" Title="票据号"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>

              <!--11.31使用部门-->
			<!--<ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/> -->

			  <!--11.31使用部门-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Department.ID"/>
			  <!-- begin: 添加自定项-->
			  <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>           
			   <!-- end: 添加自定项-->              
			   
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>

              <!--11.31使用部门-->
             <!-- <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/> -->
			  
			  <!--11.31使用部门-->
			   <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="ExpenseVoucher.Department.ID"/>
			   <!-- begin: 添加自定项-->
			  <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="ExpenseVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="ExpenseVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/> 
				<!-- end 添加自定项-->			  
				
            </Account>
          </Entry>
          <Auxiliary>
            <!--11.31统一往来单位-->
            <Property Doc="Idcustomer" SourceVoucher="ExpenseVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="ExpenseVoucher.Partner.IdpartnerClass"/>

            <Property Doc="Iddistrict" SourceVoucher="ExpenseVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="ExpenseVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="ExpenseVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="ExpenseVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="ExpenseVoucher.Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="ExpenseVoucher.Project.IdClass" Title="项目分类"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="InvoiceCode" SourceVoucher="DocumentCode"/>
            <Property Doc="idbusiType" SourceVoucher="ExpenseVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="ExpenseVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="ExpenseVoucher.VoucherDate"/>

          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ExpenseVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="ExpenseVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
	  <!-- XXdp202025323 Shicz1,2012-05-03 修改,现结 + 预付 > 总金额，转借方预付 -->
		 <TransactionEntry Code="DebitFromDiff" Name="预付生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="Tax"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigTax"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigTax"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="AdvPayment">
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
	  </TransactionDoc>
      <DocUpdateBack Title="回写" Type="Ufida.T.UA.CS.FC.DocUpdateBackExpenseVoucher" />
    </Voucher>
	
    <Voucher Code="CS03" Name="IncomeVoucherDTO"  Title="收入单">
      <SimpleQuery Title="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
        <Fields>
          <Property Name="ID" MapProperty="NEWID()" Title="Id" />
          <Property Name="UserId" MapProperty="{UserId}" Title="UserId" />
          <Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型" />
          <Property Name="VoucherId" MapProperty="IncomeVoucherDTO.ID" Title="单据Id" />
          <Property Name="VoucherDate" MapProperty="IncomeVoucherDTO.VoucherDate" Titile="单据日期"/>
          <Property Name="VoucherCode" MapProperty="IncomeVoucherDTO.Code" Titile="单据编号"/>
          <Property Name="VoucherTs" MapProperty="IncomeVoucherDTO.Ts" Title="单据时间戳"/>
          <Property Name="IdbusiType" MapProperty="IncomeVoucherDTO.idbusinessType" Titile="业务类型"/>
          <Property Name="Idcurrency" MapProperty="IncomeVoucherDTO.idcurrency" Titile="币种"/>
          <Property Name="IdbankAccount" MapProperty="IncomeVoucherDTO.MultiSettles.idbankAccount"  Titile="账号"/>
          <Property Name="Idclerck" MapProperty="IncomeVoucherDTO.idclerk" Titile="员工"/>
          <Property Name="Iddepartment" MapProperty="IncomeVoucherDTO.iddepartment" Titile="部门"/>
          <!--<Property Name="Idsupplier" MapProperty="" Titile="供应商"/>-->
          <Property Name="Idcustomer" MapProperty="IncomeVoucherDTO.idpartner" Titile="客户"/>
          <Property Name="Idproject" MapProperty="IncomeVoucherDTO.idproject" Title="项目"/>
          <Property Name="OrigAmount" MapProperty="IncomeVoucherDTO.origTaxAmountSum" Title="金额"/>
          <Property Name="Amount" MapProperty="IncomeVoucherDTO.taxAmountSum" Title="本币金额"/>
        </Fields>

        <PropertyFilters>
          <Filter Name="VoucherDate" MapProperty="IncomeVoucherDTO.VoucherDate"/>
          <Filter Name="VoucherCode" MapProperty="IncomeVoucherDTO.Code"/>
          <!--<Filter Name="SupplierCode" MapProperty=""/>-->
          <Filter Name="CustomerCode" MapProperty="IncomeVoucherDTO.Partner.Code"/>
          <Filter Name="Departments" MapProperty="IncomeVoucherDTO.iddepartment"/>
          <Filter Name="Persons" MapProperty="IncomeVoucherDTO.idclerk"/>

            <!--XXdp202025479,Shicz1,2012-05-03-->
            <!--<Filter Name="Projects" MapProperty="IncomeVoucherDTO.idproject"/>-->
          <Filter Name="Currencys" MapProperty="IncomeVoucherDTO.idcurrency"/>

            
          <Filter Name="PartnerClass" MapProperty="IncomeVoucherDTO.Partner.idpartnerclass"/>
            <!--XXdp202025479,Shicz1,2012-05-03--> 
          <!--<Filter Name="ProjectClass" MapProperty="IncomeVoucherDTO.project.idclass"/>-->

            <!--XXdp202025479,Shicz1,2012-05-03-->
          <Filter Name="Projects" MapProperty="IncomeVoucherDTO.Details.idproject"/>
          <Filter Name="ProjectClass" MapProperty="IncomeVoucherDTO.Details.project.idclass"/>
          <Filter Name="OrigAmount" MapProperty="IncomeVoucherDTO.origTaxAmountSum" />
          <Filter Name="Amount" MapProperty="IncomeVoucherDTO.taxAmountSum" />
		  <Filter Name="IncomeItem" MapProperty="IncomeVoucherDTO.Details.IdincomeItem" />
		  <Filter Name="Bankaccounts" MapProperty="IncomeVoucherDTO.MultiSettles.idbankAccount"/>
          <Filter Name="maker" MapProperty="IncomeVoucherDTO.makerid"/> 
          <Filter Name="auditor" MapProperty="IncomeVoucherDTO.auditorid"/> 
        </PropertyFilters>

        <!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
        <BusinessFilters ModeName="CashBankMoneyFlow">
          <Filter Name="未生效的不生成">
            IncomeVoucherDTO.VoucherState={VoucherState.Effective}
          </Filter>
          <Filter Name="已生成凭证的业务单据不生成">
            (IncomeVoucherDTO.DocId IS NULL or IncomeVoucherDTO.DocId='')
          </Filter>
          <Filter Name="该模块启用期间之前的期初单据不生成">
            IncomeVoucherDTO.VoucherDate>={ModelOpeningDate}
          </Filter>
			<Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
				IncomeVoucherDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
			</Filter>
        </BusinessFilters>
      </SimpleQuery>
      <FullQuery Name="完整查询设置" Type="Ufida.T.SM.FC.AbstractFullQuery">
        <Header>
          <Property Name="IncomeVoucherDTO.ID"  Title="单据ID"/>
          <Property Name="IncomeVoucherDTO.TS"  Title="TS"/>
          <Property Name="IncomeVoucherDTO.idbusinessType"  Title="业务类型ID"/>
          <Property Name="IncomeVoucherDTO.BusinessType.ID"  Title="业务类型ID"/>
          <Property Name="IncomeVoucherDTO.BusinessType.Name"  Title="业务类型"/>
          <Property Name="IncomeVoucherDTO.VoucherDate"  Title="单据日期"/>
          <Property Name="IncomeVoucherDTO.Code"  Title="单据编号"/>
          <Property Name="IncomeVoucherDTO.Memo"  Title="备注"/>
          <Property Name="IncomeVoucherDTO.PaymentAmount"  Title="使用预收本币"/>
          <Property Name="IncomeVoucherDTO.OrigPaymentAmount"  Title="使用收付"/>
          <Property Name="IncomeVoucherDTO.TaxAmountSum"  Title="含税金额本币合计"/>
          <Property Name="IncomeVoucherDTO.OrigTaxAmountSum"  Title="含税金额合计"/>
          <Property Name="IncomeVoucherDTO.Amount"  Title="现结金额合计（本币）"/>
          <Property Name="IncomeVoucherDTO.OrigAmount"  Title="现结金额合计"/>
          <Property Name="IncomeVoucherDTO.idCurrency"  Title="币种ID"/>
          <Property Name="IncomeVoucherDTO.Currency.ID"  Title="币种"/>
          <Property Name="IncomeVoucherDTO.Currency.Name"  Title="币种名称"/>
          <Property Name="IncomeVoucherDTO.ExchangeRate"  Title="汇率"/>
          <Property Name="IncomeVoucherDTO.idDepartment"  Title="部门ID"/>
          <Property Name="IncomeVoucherDTO.Department.ID"  Title="部门"/>
          <Property Name="IncomeVoucherDTO.Department.Code"  Title="部门编码"/>
          <Property Name="IncomeVoucherDTO.Department.Name"  Title="部门名称"/>
          <Property Name="IncomeVoucherDTO.Idclerk"  Title="人员ID"/>
          <Property Name="IncomeVoucherDTO.Clerk.ID"  Title="人员"/>
          <Property Name="IncomeVoucherDTO.Clerk.Code"  Title="人员编码"/>
          <Property Name="IncomeVoucherDTO.Clerk.Name"  Title="人员名称"/>
          <Property Name="IncomeVoucherDTO.idPartner"  Title="客户ID"/>
          <Property Name="IncomeVoucherDTO.Partner.ID"  Title="客户"/>
          <Property Name="IncomeVoucherDTO.Partner.Code"  Title="客户编码"/>
          <Property Name="IncomeVoucherDTO.Partner.Name"  Title="客户名称"/>
          <Property Name="IncomeVoucherDTO.Partner.IdpartnerClass"  Title="往来单位分类id"/>
          <Property Name="IncomeVoucherDTO.Partner.PartnerClass.ID"  Title="往来单位分类"/>
          <Property Name="IncomeVoucherDTO.Partner.PartnerClass.Name"  Title="往来单位名称"/>
          <Property Name="IncomeVoucherDTO.idProject"  Title="项目ID"/>
          <Property Name="IncomeVoucherDTO.Project.ID"  Title="项目"/>
          <Property Name="IncomeVoucherDTO.Project.Name"  Title="项目名称"/>
          <Property Name="IncomeVoucherDTO.Partner.Iddistrict"  Title="地区ID"/>
          <Property Name="IncomeVoucherDTO.Partner.District.ID"  Title="地区"/>
          <Property Name="IncomeVoucherDTO.Partner.District.Name"  Title="地区名称"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm6"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm1"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm2"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm3"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm4"/>
          <Property Name="IncomeVoucherDTO.pubuserdefdecm5"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc6"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc1"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc2"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc3"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc4"/>
          <Property Name="IncomeVoucherDTO.pubuserdefnvc5"/>
        </Header>
        <Details>
          <Detail DetailRuleName="MultiSettles" DTO="IncomeVoucherMultiSettleDTO" FK="IdincomeVoucherDTO" Title="现结明细">
            <Property Name="IncomeVoucherMultiSettleDTO.ID"  Title="ID"/>
            <Property Name="IncomeVoucherMultiSettleDTO.TS"  Title="TS"/>
            <Property Name="IncomeVoucherMultiSettleDTO.idSettleStyle"  Title="结算方式id"/>
            <Property Name="IncomeVoucherMultiSettleDTO.SettleStyle.ID"  Title="结算方式"/>
            <Property Name="IncomeVoucherMultiSettleDTO.idBankAccount"  Title="账号id"/>
            <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.ID"  Title="账号"/>
            <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.BankNoType.ID"  Title="账号类型id"/>
            <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.Idcurrency"  Title="账号币种id"/>
			
           <!-- begin: 添加部门 -->
		   <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.Department.ID"  Title="部门id"/>
		   <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.Department.Code"  Title="部门code"/>
		   <Property Name="IncomeVoucherMultiSettleDTO.BankAccount.Department.Name"  Title="部门name"/>
			<!-- end: 添加部门 -->
			
		   <Property Name="IncomeVoucherMultiSettleDTO.DocumentCode"  Title="票据号"/>
            <Property Name="IncomeVoucherMultiSettleDTO.Amount"  Title="收款金额本币"/>
            <Property Name="IncomeVoucherMultiSettleDTO.OrigAmount"  Title="收款金额"/>
          </Detail>
          <Detail DetailRuleName="Details" DTO="IncomeVoucherDetailDTO" FK="IdincomeVoucherDTO" Title="明细">
            <Property Name="IncomeVoucherDetailDTO.ID"  Title="ID"/>
            <Property Name="IncomeVoucherDetailDTO.TS"  Title="TS"/>
            <Property Name="IncomeVoucherDetailDTO.OrigAmount"  Title="金额"/>
            <Property Name="IncomeVoucherDetailDTO.Amount"  Title="本币金额"/>
            <Property Name="IncomeVoucherDetailDTO.OrigTax"  Title="税额"/>
            <Property Name="IncomeVoucherDetailDTO.Tax"  Title="本币税额"/>
            <Property Name="IncomeVoucherDetailDTO.OrigTaxAmount"  Title="含税金额"/>
            <Property Name="IncomeVoucherDetailDTO.TaxAmount"  Title="本币含税金额"/>
            <Property Name="IncomeVoucherDetailDTO.OrigSettleAmount"  Title="累计结算金额"/>
            <Property Name="IncomeVoucherDetailDTO.SettleAmount"  Title="累计结算金额本币"/>
            <Property Name="IncomeVoucherDetailDTO.IdincomeItem"  Title="收入id"/>
            <Property Name="IncomeVoucherDetailDTO.IncomeItem.ID"  Title="收入"/>
            <Property Name="IncomeVoucherDetailDTO.idProject"  Title="项目ID"/>
            <Property Name="IncomeVoucherDetailDTO.Project.ID"  Title="项目"/>
            <Property Name="IncomeVoucherDetailDTO.Project.Name"  Title="项目名称"/>
            <Property Name="IncomeVoucherDetailDTO.Project.IdClass"  Title="项目分类"/>
            <Property Name="IncomeVoucherDetailDTO.Project.Class.ID"  Title="项目分类"/>
            <Property Name="IncomeVoucherDetailDTO.Project.Class.Name"  Title="项目分类"/>
            <Property Name="IncomeVoucherDetailDTO.Project.Class.Code"  Title="项目分类"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefdecm4"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefdecm1"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefdecm2"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefdecm3"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefnvc4"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefnvc1"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefnvc2"/>
            <Property Name="IncomeVoucherDetailDTO.pubuserdefnvc3"/>
          </Detail>
        </Details>
      </FullQuery>
      <TransactionDoc Type="Ufida.T.UA.CS.FC.IncomeVoucher">
        <SummaryFields>
          <Property Name="VoucherTypeId" Mapping="ID" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="idbusinessType" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="BusinessType.Name" Title="业务类型"/>
          <Property Name="Partner" Mapping="Partner.Name" Title="往来单位"/>
          <Property Name="Department" Mapping="Department.Name" Title="部门"/>
          <Property Name="Person" Mapping="Clerk.Name" Title="人员"/>
          <Property Name="Memo" Mapping="Memo" Title="备注"/>
        </SummaryFields>
        <TransactionEntry Code="DebitFromAr" Name="应收生成借方" DCDirection="Debit">
          <Entry>
            <!-- 按照明细修改11。3-->
            <Property Doc="AmountDr" SourceVoucher="TaxAmount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigTaxAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>
            
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="IncomeVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="IncomeVoucher.Memo"/>
            <Account AccountRuleType="OtherAr">
              <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="IncomeVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="IncomeVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddistrict" SourceVoucherProperty="IncomeVoucher.Partner.Iddistrict"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="IncomeVoucher.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="IncomeVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idProject"/>
              <!--11.31-->
              <!--<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>           
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="IncomeVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="IncomeVoucher.Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="IncomeVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="IncomeVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="IncomeVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="IncomeVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="IncomeVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="IncomeVoucher.VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <!--<Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>-->
            <Property Doc="SourceVoucherId" SourceVoucher="IncomeVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="IncomeVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="DebitFromCash" Name="现结生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="Amount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="IncomeVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="IncomeVoucher.Memo"/>
            <Property Doc="BillNo" SourceVoucher="DocumentCode" Title="票据号"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              <!--11.31使用部门-->
              <!--<ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>-->
			  <!--11.31使用部门-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="IncomeVoucher.Department.ID"/>
			  <!-- begin: 添加自定项-->
			  <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>           
			   <!-- end: 添加自定项-->              
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>

              <!--11.31使用部门-->
             <!-- <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>-->
			  
			  <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="IncomeVoucher.Department.ID"/>
			   <!-- begin: 添加自定项-->
			  <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/> 
				<!-- end 添加自定项-->			  
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="IncomeVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="IncomeVoucher.Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="IncomeVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="IncomeVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="IncomeVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="InvoiceCode" SourceVoucher="DocumentCode"/>
            <Property Doc="idbusiType" SourceVoucher="IncomeVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="IncomeVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="IncomeVoucher.VoucherDate"/>

            <!--11.31使用部门--><!--
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="IncomeVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="IncomeVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromIncome" Name="明细金额生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="Amount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="IncomeVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="IncomeVoucher.Memo"/>
            <Account AccountRuleType="Income">
              <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="IncomeVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="IncomeVoucher.Idpartner"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="IncomeVoucher.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="Idproject"/>
              <ExtendRuleProperty Name="Idincome" SourceVoucherProperty="IdincomeItem"/>

              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="IncomeVoucher.pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="IncomeVoucher.pubuserdefnvc6"/>

              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="IncomeVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="IncomeVoucher.Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="IncomeVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="IncomeVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="IncomeVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="IncomeVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="IncomeVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="IncomeVoucher.VoucherDate"/>
            <Property Doc="Idincome" SourceVoucher="Idincomeitem"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="IncomeVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="IncomeVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromTaxAmount" Name="税金生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="Tax"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigTax"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigTax"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="IncomeVoucher.ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="IncomeVoucher.Memo"/>
            <Account AccountRuleType="SalesTax">
              <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="IncomeVoucher.Partner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="IncomeVoucher.Idpartner"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="IncomeVoucher.Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="IncomeVoucher.Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="IncomeVoucher.Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="IncomeVoucher.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="IncomeVoucher.Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="IncomeVoucher.Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="IncomeVoucher.idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="IncomeVoucher.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="IncomeVoucher.VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="IncomeVoucher.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="IncomeVoucher.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
		<!-- 现结 + 预收 > 总金额，转预收 -->
		 <TransactionEntry Code="CreditFromDiff" Name="预收生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="Tax"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigTax"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigTax"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="AdvReceive">
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idcustomer" SourceVoucher="Idpartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="Partner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="Partner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="Idclerk"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency"/>
            <Property Doc="Idproject" SourceVoucher="Idproject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="idbusiType" SourceVoucher="idbusinessType"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
      </TransactionDoc>
      <DocUpdateBack Title="回写" Type="Ufida.T.UA.CS.FC.DocUpdateBackIncomeVoucher" />
    </Voucher>
	
    <Voucher Code="CS06" Name="CashAccountDailyDTO"  Title="现金银行日记账">
      <SimpleQuery Title="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">

        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
        <Fields>
          <Property Name="ID" MapProperty="NEWID()" Title="Id" />
          <Property Name="UserId" MapProperty="{UserId}" Title="UserId" />
          <Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型" />
          <Property Name="VoucherId" MapProperty="CashAccountDailyDTO.ID" Title="单据Id" />
          <!--<Property Name="IdbusiType" MapProperty="" Titile="业务类型"/>-->
          <Property Name="VoucherDate" MapProperty="CashAccountDailyDTO.VoucherDate" Titile="单据日期"/>
          <Property Name="VoucherCode" MapProperty="CashAccountDailyDTO.Code" Titile="单据编号"/>
          <Property Name="VoucherTs" MapProperty="CashAccountDailyDTO.Ts" Title="单据时间戳"/>
          <Property Name="IdbankAccount" MapProperty="CashAccountDailyDTO.idbankAccount"  Titile="账号"/>
          <Property Name="Idcurrency" MapProperty="CashAccountDailyDTO.BankAccount.Idcurrency"  Titile="币种"/>
          <Property Name="Iddepartment" MapProperty="CashAccountDailyDTO.Idprodepartment" Titile="部门"/>
          <Property Name="Idproject" MapProperty="CashAccountDailyDTO.Idproject" Titile="项目"/>
          <Property Name="Idclerck" MapProperty="CashAccountDailyDTO.idPerson" Titile="员工"/>
          <Property Name="Idsupplier" MapProperty="CashAccountDailyDTO.idOtherPartner" Titile="供应商"/>
          <Property Name="Idcustomer" MapProperty="CashAccountDailyDTO.idOtherPartner" Titile="客户"/>
          <Property Name="BillDate" MapProperty="CashAccountDailyDTO.BillDate" Title="票据日期"/>
          <Property Name="OrigAmount" MapProperty="CashAccountDailyDTO.OrigAmountDr" Title="金额"/>
          <Property Name="Amount" MapProperty="CashAccountDailyDTO.AmountDr" Title="本币金额"/>
        </Fields>

        <PropertyFilters>
          <Filter Name="VoucherDate" MapProperty="CashAccountDailyDTO.VoucherDate"/>
          <Filter Name="VoucherCode" MapProperty="CashAccountDailyDTO.Code"/>
          <Filter Name="CustomerCode" MapProperty="CashAccountDailyDTO.OtherPartner.code"/>
          <Filter Name="Departments" MapProperty="CashAccountDailyDTO.Idprodepartment"/>
          <Filter Name="Persons" MapProperty="CashAccountDailyDTO.idPerson"/>
          <Filter Name="Projects" MapProperty="CashAccountDailyDTO.Idproject"/>
          <Filter Name="Currencys" MapProperty="CashAccountDailyDTO.BankAccount.idcurrency"/>
          <Filter Name="SettleStyles" MapProperty="CashAccountDailyDTO.idsettleStyle"/>
          <Filter Name="Bankaccounts" MapProperty="CashAccountDailyDTO.idbankAccount"/>
          <Filter Name="OrigAmount" MapProperty="CashAccountDailyDTO.OrigAmountDr" />
          <Filter Name="Amount" MapProperty="CashAccountDailyDTO.AmountDr" />
          <Filter Name="maker" MapProperty="CashAccountDailyDTO.makerid"/>
          <Filter Name="auditor" MapProperty="CashAccountDailyDTO.makerid"/>
        </PropertyFilters>

        <!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
        <BusinessFilters ModeName="CS">
          <Filter Name="已生成凭证的业务单据不生成">
            (CashAccountDailyDTO.DocId IS NULL or CashAccountDailyDTO.DocId='')
          </Filter>
          <Filter Name="该模块启用期间之前的期初单据不生成">
            CashAccountDailyDTO.VoucherDate>={ModelOpeningDate}
          </Filter>
          <Filter Name="引入记录不能生成凭证">
            CashAccountDailyDTO.IsAuto=0 AND CashAccountDailyDTO.IsPushAuto=0
          </Filter>
			<Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
				CashAccountDailyDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
			</Filter>
        </BusinessFilters>
      </SimpleQuery>
      <FullQuery Name="完整查询设置" Type="Ufida.T.SM.FC.AbstractFullQuery">
        <Header>
          <Property Name="CashAccountDailyDTO.ID"  Title="单据ID"/>
          <Property Name="CashAccountDailyDTO.TS"  Title="TS"/>
          <Property Name="CashAccountDailyDTO.VoucherDate"  Title="单据日期"/>
          <Property Name="CashAccountDailyDTO.Code"  Title="单据编号"/>
          <Property Name="CashAccountDailyDTO.Summary"  Title="摘要"/>
          <Property Name="CashAccountDailyDTO.AmountDr"  Title="借方本币"/>
          <Property Name="CashAccountDailyDTO.OrigAmountDr"  Title="借方"/>
          <Property Name="CashAccountDailyDTO.AmountCr"  Title="贷方本币"/>
          <Property Name="CashAccountDailyDTO.OrigAmountCr"  Title="贷方"/>
          <Property Name="CashAccountDailyDTO.ExchangeDr"  Title="借方汇率"/>
          <Property Name="CashAccountDailyDTO.ExchangeCr"  Title="贷方汇率"/>
          <Property Name="CashAccountDailyDTO.IdBankAccount"  Title="账号ID"/>
          <Property Name="CashAccountDailyDTO.BankAccount.ID"  Title="账号"/>
          <Property Name="CashAccountDailyDTO.BankAccount.Name"  Title="账号名称"/>
          <Property Name="CashAccountDailyDTO.BankAccount.Idcurrency"  Title="账号币种"/>
          <Property Name="CashAccountDailyDTO.BankAccount.BankNoType.ID"  Title="账号类型id"/>
          <Property Name="CashAccountDailyDTO.idProDepartment"  Title="部门ID"/>
          <Property Name="CashAccountDailyDTO.ProDepartment.ID"  Title="部门"/>
          <Property Name="CashAccountDailyDTO.ProDepartment.Code"  Title="部门编码"/>
          <Property Name="CashAccountDailyDTO.ProDepartment.Name"  Title="部门名称"/>
          <Property Name="CashAccountDailyDTO.Idperson"  Title="人员ID"/>
          <Property Name="CashAccountDailyDTO.Person.ID"  Title="人员"/>
          <Property Name="CashAccountDailyDTO.Person.Code"  Title="人员编码"/>
          <Property Name="CashAccountDailyDTO.Person.Name"  Title="人员名称"/>
          <Property Name="CashAccountDailyDTO.BillCode"  Title="票号"/>
          <Property Name="CashAccountDailyDTO.BillDate"  Title="票据日期"/>
          <Property Name="CashAccountDailyDTO.IdsettleStyle"  Title="结算方式ID"/>
          <Property Name="CashAccountDailyDTO.SettleStyle.ID"  Title="结算方式"/>
          <Property Name="CashAccountDailyDTO.BankAccount.idDepartment"  Title="部门ID"/>
          <Property Name="CashAccountDailyDTO.BankAccount.Department.ID"  Title="部门"/>
          <Property Name="CashAccountDailyDTO.BankAccount.Department.Name"  Title="部门名称"/>
          <Property Name="CashAccountDailyDTO.idOtherPartner"  Title="往来单位ID"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.ID"  Title="往来单位"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.Code"  Title="往来单位编码"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.Name"  Title="往来单位名称"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.IdpartnerClass"  Title="往来单位分类id"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.PartnerClass.ID"  Title="往来单位分类"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.PartnerClass.Name"  Title="往来单位名称"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.Iddistrict"  Title="地区ID"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.District.ID"  Title="地区"/>
          <Property Name="CashAccountDailyDTO.OtherPartner.District.Name"  Title="地区名称"/>
          <Property Name="CashAccountDailyDTO.idproject"  Title="项目"/>
          <Property Name="CashAccountDailyDTO.Project.ID"  Title="项目"/>
          <Property Name="CashAccountDailyDTO.Project.Name"  Title="项目"/>
          <Property Name="CashAccountDailyDTO.Project.Code"  Title="项目"/>
          <Property Name="CashAccountDailyDTO.Project.IdClass"  Title="项目分类"/>
          <Property Name="CashAccountDailyDTO.Project.Class.ID"  Title="项目分类"/>
          <Property Name="CashAccountDailyDTO.Project.Class.Name"  Title="项目分类"/>
          <Property Name="CashAccountDailyDTO.Project.Class.Code"  Title="项目分类"/>
          <Property Name="CashAccountDailyDTO.pubuserdefdecm4"/>
          <Property Name="CashAccountDailyDTO.pubuserdefdecm1"/>
          <Property Name="CashAccountDailyDTO.pubuserdefdecm2"/>
          <Property Name="CashAccountDailyDTO.pubuserdefdecm3"/>
          <Property Name="CashAccountDailyDTO.pubuserdefnvc4"/>
          <Property Name="CashAccountDailyDTO.pubuserdefnvc1"/>
          <Property Name="CashAccountDailyDTO.pubuserdefnvc2"/>
          <Property Name="CashAccountDailyDTO.pubuserdefnvc3"/>
        </Header>
      </FullQuery>
      <TransactionDoc Type="Ufida.T.UA.CS.FC.CashAccountDaily">
        <SummaryFields>
          <Property Name="VoucherTypeId" Mapping="ID" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="" Title="业务类型"/>
          <Property Name="Partner" Mapping="" Title="往来单位"/>
          <Property Name="Department" Mapping="" Title="部门"/>
          <Property Name="Person" Mapping="Person.Name" Title="人员"/>
          <Property Name="Memo" Mapping="Summary" Title="备注"/>
        </SummaryFields>
        <TransactionEntry Code="DebitFromDebit" Name="借方生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="AmountDr"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigAmountDr"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmountDr"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeDr"/>
            <Property Doc="BillNo" SourceVoucher="BillCode"/>
            <Property Doc="BillDate" SourceVoucher="BillDate"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>

              <!--11.31-->
              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="Idcustomer" SourceVoucher="idOtherPartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="OtherPartner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="OtherPartner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="idProDepartment"/>
            <Property Doc="Idproject" SourceVoucher="IdProject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="InvoiceCode" SourceVoucher="BillCode"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="DebitFromCredit" Name="借方生成对方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="AmountDr"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigAmountDr"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmountDr"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeDr"/>
            <Property Doc="BillNo" SourceVoucher="BillCode"/>
            <Property Doc="BillDate" SourceVoucher="BillDate"/>
            <Account AccountRuleType="DailyPartner">
              <ExtendRuleProperty Name="incomeExpensesType" SourceVoucherProperty="incomeExpensesType"/>
	      <ExtendRuleProperty Name="summary" SourceVoucherProperty="Summary"/>
	      <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>
	      <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="idOtherPartner"/>
	      <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="OtherPartner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idproject"/>
              <ExtendRuleProperty Name="idProjectClass" SourceVoucherProperty="Project.IdClass"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="Idcustomer" SourceVoucher="idOtherPartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="OtherPartner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="OtherPartner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="idProDepartment"/>
            <Property Doc="Idproject" SourceVoucher="IdProject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="InvoiceCode" SourceVoucher="BillCode"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门-->
            <!--<Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>

        <TransactionEntry Code="CreditFromCredit" Name="贷方生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="AmountCr"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigAmountCr"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmountCr"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeCr"/>
            <Property Doc="BillNo" SourceVoucher="BillCode"/>
            <Property Doc="BillDate" SourceVoucher="BillDate"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>
            <Account AccountRuleType="Bank">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
            </Account>

          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="Idcustomer" SourceVoucher="idOtherPartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="OtherPartner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="OtherPartner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="idProDepartment"/>
            <Property Doc="Idproject" SourceVoucher="IdProject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="InvoiceCode" SourceVoucher="BillCode"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromDebit" Name="贷方生成对方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="AmountCr"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigAmountCr"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigAmountCr"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeCr"/>
            <Property Doc="BillNo" SourceVoucher="BillCode"/>
            <Property Doc="BillDate" SourceVoucher="BillDate"/>
            <Account AccountRuleType="DailyPartner">
              <ExtendRuleProperty Name="incomeExpensesType" SourceVoucherProperty="incomeExpensesType"/>
	      <ExtendRuleProperty Name="summary" SourceVoucherProperty="Summary"/>
	      <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="idProDepartment"/>
	      <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="idOtherPartner"/>
	      <ExtendRuleProperty Name="Idpartnerclass" SourceVoucherProperty="OtherPartner.IdpartnerClass"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="idproject"/>
              <ExtendRuleProperty Name="idProjectClass" SourceVoucherProperty="Project.IdClass"/>
            </Account>

          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="Idcustomer" SourceVoucher="idOtherPartner"/>
            <Property Doc="IdcustomerClass" SourceVoucher="OtherPartner.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="OtherPartner.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="idProDepartment"/>
            <Property Doc="Idproject" SourceVoucher="IdProject"/>
            <Property Doc="IdprojectClass" SourceVoucher="Project.IdClass" Title="项目分类"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
            <Property Doc="InvoiceCode" SourceVoucher="BillCode"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>

      </TransactionDoc>
      <DocUpdateBack Title="回写" Type="Ufida.T.UA.CS.FC.DocUpdateBackCashAccountDaily" />
    </Voucher>
    <Voucher Code="CS07" Name="CashCheckVoucherDTO"  Title="现金盘点单">
      <SimpleQuery Name="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">

        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
        <!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
        <Fields>
          <Property Name="ID" MapProperty="NEWID()" Title="Id" />
          <Property Name="UserId" MapProperty="{UserId}" Title="UserId" />
          <Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型" />
          <Property Name="VoucherId" MapProperty="CashCheckVoucherDTO.ID" Title="单据Id" />
          <!--<Property Name="IdbusiType" MapProperty="" Titile="业务类型"/>-->
          <Property Name="VoucherDate" MapProperty="CashCheckVoucherDTO.VoucherDate" Titile="单据日期"/>
          <Property Name="VoucherCode" MapProperty="CashCheckVoucherDTO.Code" Titile="单据编号"/>
          <Property Name="IdbankAccount" MapProperty="CashCheckVoucherDTO.idbankAccount"  Titile="账号"/>
          <Property Name="Idcurrency" MapProperty="CashCheckVoucherDTO.BankAccount.Idcurrency"  Titile="币种"/>
          <Property Name="VoucherTs" MapProperty="CashCheckVoucherDTO.Ts" Title="单据时间戳"/>
          <!--<Property Name="Iddepartment" MapProperty="" Titile="部门"/>-->
          <Property Name="Idclerck" MapProperty="CashCheckVoucherDTO.idperson" Titile="员工"/>
          <!--<Property Name="Idsupplier" MapProperty="" Titile="供应商"/>-->
          <!--<Property Name="Idcustomer" MapProperty="" Titile="客户"/>-->
          <Property Name="OrigAmount" MapProperty="CashCheckVoucherDTO.OrigProfitLossAmount" Title="金额"/>
          <Property Name="Amount" MapProperty="CashCheckVoucherDTO.ProfitLossAmount" Title="本币金额"/>
        </Fields>

        <PropertyFilters>
          <Filter Name="VoucherDate" MapProperty="CashCheckVoucherDTO.VoucherDate"/>
          <Filter Name="VoucherCode" MapProperty="CashCheckVoucherDTO.Code"/>
          <!--<Filter Name="SupplierCode" MapProperty=""/>
          <Filter Name="CustomerCode" MapProperty=""/>
          <Filter Name="Departments" MapProperty=""/>-->
          <Filter Name="Persons" MapProperty="CashCheckVoucherDTO.idperson"/>
          <!--<Filter Name="Projects" MapProperty=""/>-->
          <Filter Name="Currencys" MapProperty="CashCheckVoucherDTO.BankAccount.idcurrency"/>
          <Filter Name="Bankaccounts" MapProperty="CashCheckVoucherDTO.idbankAccount"/>
          <Filter Name="OrigAmount" MapProperty="CashCheckVoucherDTO.OrigProfitLossAmount" />
          <Filter Name="Amount" MapProperty="CashCheckVoucherDTO.ProfitLossAmount" />
          <Filter Name="maker" MapProperty="CashCheckVoucherDTO.makerid"/>
          <Filter Name="auditor" MapProperty="CashCheckVoucherDTO.auditorid"/>
        </PropertyFilters>

        <!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
        <BusinessFilters ModeName="CS">
          <Filter Name="未生效的不生成">
            CashCheckVoucherDTO.VoucherState={VoucherState.Effective}
          </Filter>
          <Filter Name="已生成凭证的业务单据不生成">
            (CashCheckVoucherDTO.DocId IS NULL or CashCheckVoucherDTO.DocId='')
          </Filter>
          <Filter Name="该模块启用期间之前的期初单据不生成">
            CashCheckVoucherDTO.VoucherDate>={ModelOpeningDate}
          </Filter>
          <Filter Name="账实相符的不生成">
            CashCheckVoucherDTO.CheckState!='D7E9B13B-B072-4BD5-A02E-E16B4135253E'
          </Filter>
			<Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
				CashCheckVoucherDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
			</Filter>
        </BusinessFilters>

        <IsContainZero Name="明细金额全为0不显示">
          abs(CashCheckVoucherDTO.OrigProfitLossAmount)!=0
        </IsContainZero>

      </SimpleQuery>
      <FullQuery Name="完整查询设置" Type="Ufida.T.SM.FC.AbstractFullQuery">
        <Header>
          <Property Name="CashCheckVoucherDTO.ID"  Title="单据ID"/>
          <Property Name="CashCheckVoucherDTO.TS"  Title="TS"/>
          <Property Name="CashCheckVoucherDTO.VoucherDate"  Title="单据日期"/>
          <Property Name="CashCheckVoucherDTO.Code"  Title="单据编号"/>
          <Property Name="CashCheckVoucherDTO.Memo"  Title="备注"/>
          <Property Name="CashCheckVoucherDTO.ProfitLossAmount"  Title="本币亏盈"/>
          <Property Name="CashCheckVoucherDTO.OrigProfitLossAmount"  Title="亏盈金额"/>
          <Property Name="CashCheckVoucherDTO.CheckState"  Title="盘点结果"/>
          <Property Name="CashCheckVoucherDTO.Exchange"  Title="汇率"/>
          <Property Name="CashCheckVoucherDTO.IdBankAccount"  Title="账号ID"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.ID"  Title="账号"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.Name"  Title="账号名称"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.Idcurrency"  Title="账号币种"/>
          <Property Name="CashCheckVoucherDTO.Idperson"  Title="人员ID"/>
          <Property Name="CashCheckVoucherDTO.Person.ID"  Title="人员"/>
          <Property Name="CashCheckVoucherDTO.Person.Code"  Title="人员编码"/>
          <Property Name="CashCheckVoucherDTO.Person.Name"  Title="人员名称"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.idDepartment"  Title="部门ID"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.Department.ID"  Title="部门"/>
          <Property Name="CashCheckVoucherDTO.BankAccount.Department.Name"  Title="部门名称"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm6"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm1"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm2"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm3"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm4"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefdecm5"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc6"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc1"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc2"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc3"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc4"/>
          <Property Name="CashCheckVoucherDTO.pubuserdefnvc5"/>
        </Header>
      </FullQuery>
      <TransactionDoc Type="Ufida.T.UA.CS.FC.CashCheckVoucher">
        <SummaryFields>
          <Property Name="VoucherTypeId" Mapping="ID" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="" Title="业务类型"/>
          <Property Name="Partner" Mapping="" Title="往来单位"/>
          <Property Name="Department" Mapping="" Title="部门"/>
          <Property Name="Person" Mapping="Person.Name" Title="人员"/>
          <Property Name="Memo" Mapping="Memo" Title="备注"/>
        </SummaryFields>
        <!--盘亏-->
        <TransactionEntry Code="DebitFromPropertyAdjust" Name="待处理财产损溢生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="ProfitLossAmount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="Exchange"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="PendingAccount">
              <ExtendRuleProperty Name="IdvoucherType" SourceVoucherProperty="{IdvoucherType}"/>
              <ExtendRuleProperty Name="CheckState" SourceVoucherProperty="{IdCheckState}"/>

              <!--11.31使用部门-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门-->
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromCash" Name="现金生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="ProfitLossAmount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="Exchange"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>
              
              <!--11.31使用部门-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门-->
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <!--盘亏-->
        <!--盘赢-->
        <TransactionEntry Code="DebitFromCash" Name="现金生成借方" DCDirection="Debit">
          <Entry>
            <Property Doc="AmountDr" SourceVoucher="ProfitLossAmount"/>
            <Property Doc="OrigAmountDr" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="Exchange"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="Cash">
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="BankAccount.Idcurrency"/>

              <!--11.31使用部门-->
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>
              
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门-->
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="CreditFromPropertyAdjust" Name="待处理财产损溢生成贷方" DCDirection="Credit">
          <Entry>
            <Property Doc="AmountCr" SourceVoucher="ProfitLossAmount"/>
            <Property Doc="OrigAmountCr" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="OrigAmount" SourceVoucher="OrigProfitLossAmount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="ExchangeRate" SourceVoucher="Exchange"/>
            <Property Doc="Memoto" SourceVoucher="Memo"/>
            <Account AccountRuleType="PendingAccount">
              <ExtendRuleProperty Name="IdvoucherType" SourceVoucherProperty="{IdvoucherType}"/>
              <ExtendRuleProperty Name="CheckState" SourceVoucherProperty="{IdCheckState}"/>

              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="BankAccount.idDepartment"/>
              <!--11.31-->
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="pubuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="pubuserdefdecm6"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="pubuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="pubuserdefnvc6"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Idperson" SourceVoucher="Idperson"/>
            <Property Doc="IdbankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="Idcurrency" SourceVoucher="BankAccount.Idcurrency"/>
            <Property Doc="VoucherCode" SourceVoucher="Code"/>
            <Property Doc="VoucherDate" SourceVoucher="VoucherDate"/>
            <!--11.31使用部门-->
            <Property Doc="Iddepartment" SourceVoucher="BankAccount.idDepartment"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <!--盘赢-->
      </TransactionDoc>
      <DocUpdateBack Title="回写" Type="Ufida.T.UA.CS.FC.DocUpdateBackCashCheckVoucher" />
    </Voucher>

    <DocReIndexs>
      <DocReIndex Name="现金银行日记账" TableName="CS_CashAccountDaily" DocIdField="DocId" DocCodeField="DocNo"/>
    </DocReIndexs>
  </Modle>
</DocSourceVoucher>
