<?xml version="1.0"?>
<!--文件说明 ： 凭证接口相关配置信息                  -->
<!--    作者 ： 杨超                               -->
<!--    日期 ： 2012-7-20                             -->
<!--    说明 ： 更多信息请参考凭证接口设计文档和代码   -->
<DocSourceVoucher  Cached="False">
	<Modle Name="RE">
		<Runtimes>
			<Runtime Name="Ufida.T.RE.DTO"/>
			<Runtime Name="Ufida.T.UA.RE"/>
			<Runtime Name="Ufida.T.SM.FC"/>
		</Runtimes>
		<Voucher Code="RE20" Name="RetailSettleDTO" Title="零售结算单">
			<SimpleQuery Title="简单查询设置" Type="Ufida.T.SM.FC.AbstractSimpleQuery">
				<!--当前单据到FC_DocSimpleSourceVoucher字段的映射,如果没有某个字段设置为NULL-->
				<!--当前单据到FC_DocSimpleSourceVoucher字段的映射,SELECT部分和WHERE部分都需要配置-->
				<Fields>
					<Property Name="ID" MapProperty="NEWID()" Title="主键" />
					<Property Name="UserId" MapProperty="{UserId}" Title="用户ID" />

					<Property Name="VoucherId" MapProperty="RetailSettleDTO.ID" Title="单据Id"/>
					<Property Name="VoucherDate" MapProperty="RetailSettleDTO.VoucherDate" Title="单据日期"/>
					<Property Name="VoucherCode" MapProperty="RetailSettleDTO.Code" Title="单据编号"/>
					<Property Name="VoucherTs" MapProperty="RetailSettleDTO.TS" Title="单据时间戳"/>
					<Property Name="Idproject" MapProperty="RetailSettleDTO.Idproject" Title="项目"/>
					<Property Name="IdvoucherType" MapProperty="{IdvoucherType}" Title="单据类型"/>
					<Property Name="Idcustomer" MapProperty="RetailSettleDTO.IdSettleCustomer" Title="客户"/>
					<Property Name="Iddepartment" MapProperty="RetailSettleDTO.Store.Iddepartment" Title="部门"/>
          <Property Name="OrigAmount" MapProperty="RetailSettleDTO.totalSettleTaxAmount" Title="金额"/>
          <Property Name="Amount" MapProperty="RetailSettleDTO.totalSettleTaxAmount" Title="本币金额"/>
          <!--因为零售结算单不区分本币，外币  所以都是取值金额字段-->
          <!--<Property Name="Idclerck" MapProperty="RetailSettleDTO.Idclerk" Title="业务员"/>-->
					<!--<Property Name="Idcurrency" MapProperty="RetailSettleDTO.Idcurrency" Title="币种"/>-->

				</Fields>

				<PropertyFilters>
					<Filter Name="VoucherDate" MapProperty="RetailSettleDTO.VoucherDate" Title="单据日期"/>
					<Filter Name="VoucherCode" MapProperty="RetailSettleDTO.Code" Title="单据编号"/>
					<Filter Name="CustomerCode" MapProperty="RetailSettleDTO.SettleCustomer.Code" Title="客户"/>
					<Filter Name="PartnerClass" MapProperty="RetailSettleDTO.SettleCustomer.IdpartnerClass" Title="客户分类"/>
					<Filter Name="InventoryCode" MapProperty="RetailSettleDTO.Details.Inventory.Code" Title="存货"/>
					<Filter Name="InventoryClasss" MapProperty="RetailSettleDTO.Details.Inventory.IdinventoryClass" Title="存货分类"/>
					<!--<Filter Name="ProjectClass" MapProperty="RetailSettleDTO.RetailSettleDetails.Project.IdClass" Title="项目分类"/>-->
					<Filter Name="Departments" MapProperty="RetailSettleDTO.Store.Iddepartment" Title="部门"/>
					<!--<Filter Name="Persons" MapProperty="RetailSettleDTO.Idclerk" Title="员工"/>-->
					<!--<Filter Name="Currencys" MapProperty="RetailSettleDTO.Idcurrency" Title="币种"/>-->
          <Filter Name="OrigAmount" MapProperty="RetailSettleDTO.Details.Amount" Title="金额"/>
          <Filter Name="Amount" MapProperty="RetailSettleDTO.Details.Amount" Title="本币金额"/>
          <Filter Name="Bankaccounts" MapProperty="RetailSettleDTO.MutiSettleDetails.IdbankAccount" Title="账号"/>
					<Filter Name="SettleStyles" MapProperty="RetailSettleDTO.MutiSettleDetails.IdsettleStyle" Title="结算方式"/>
					<Filter Name="maker" MapProperty="RetailSettleDTO.makerid"/>
					<Filter Name="auditor" MapProperty="RetailSettleDTO.auditorid"/>
				</PropertyFilters>

				<!--查询单据的过滤条件，多是不生成凭证过滤条件，也可以添加其他的自定义条件-->
				<BusinessFilters ModeName="PS">
					<Filter Name="未生效的不生成">
            RetailSettleDTO.VoucherState={VoucherState.Effective}
          </Filter>
					<Filter Name="已生成凭证的业务单据不生成">
            RetailSettleDTO.DocId IS NULL
          </Filter>
					<Filter Name="若本账套已期间结转，不能筛选出账套结转期间之后的单据生成凭证">
						1=1
					</Filter>
					<Filter Name="该模块启用期间之前的期初单据不生成">
            RetailSettleDTO.VoucherDate>{ModelOpeningDate}
          </Filter>					
					<Filter Name="零售结算单记账">
            (select value from EAP_AccInformation where Name='Retail') = 1
          </Filter>
          <Filter Name="所属营销机构 !=“总部”的单据不生成凭证">
            RetailSettleDTO.IdmarketingOrgan='4AD74463-E871-4DC1-BEB0-6E6EAA0A6386'
          </Filter>
				</BusinessFilters>
				<IsContainZero Name="明细金额全为0不显示">
          Exists
          (
          select Detail.id from RE_RetailSettle_b Detail where Detail.idRetailSettleDTO=RetailSettleDTO.id and abs(Detail.Amount)>0
          )
        </IsContainZero>
			</SimpleQuery>
			<FullQuery Name="完整查询设置" Type="Ufida.T.UA.RE.FC.FullQueryRetailSettle">
				<Header>
					<Property Name="RetailSettleDTO.ID"  Title="单据ID"/>
					<Property Name="RetailSettleDTO.TS"  Title="TS"/>
					<Property Name="RetailSettleDTO.VoucherDate"  Title="单据日期"/>
					<Property Name="RetailSettleDTO.Code"  Title="单据编号"/>
					<Property Name="RetailSettleDTO.Memo"  Title="备注"/>
					<Property Name="RetailSettleDTO.SettleAmount"  Title="现结金额合计"/>
          <Property Name="RetailSettleDTO.WipeChange"  Title="抹零"/>
					<!--<Property Name="RetailSettleDTO.idCurrency"  Title="币种ID"/>
					<Property Name="RetailSettleDTO.Currency.ID"  Title="币种"/>
					<Property Name="RetailSettleDTO.Currency.Name"  Title="币种名称"/>-->
          <Property Name="RetailSettleDTO.idStore"  Title="门店ID"/>
          <Property Name="RetailSettleDTO.Store.ID"  Title="门店"/>
          <Property Name="RetailSettleDTO.Store.Code"  Title="门店编码"/>
          <Property Name="RetailSettleDTO.Store.Name"  Title="门店名称"/>
					<Property Name="RetailSettleDTO.Store.idDepartment"  Title="部门ID"/>
					<Property Name="RetailSettleDTO.Store.Department.ID"  Title="部门"/>
					<Property Name="RetailSettleDTO.Store.Department.Code"  Title="部门编码"/>
					<Property Name="RetailSettleDTO.Store.Department.Name"  Title="部门名称"/>
					<Property Name="RetailSettleDTO.idPerson"  Title="人员ID"/>
					<Property Name="RetailSettleDTO.Person.ID"  Title="人员"/>
					<Property Name="RetailSettleDTO.Person.Code"  Title="人员编码"/>
					<Property Name="RetailSettleDTO.Person.Name"  Title="人员名称"/>
					<Property Name="RetailSettleDTO.idSettleCustomer"  Title="客户ID"/>
					<Property Name="RetailSettleDTO.SettleCustomer.ID"  Title="客户"/>
					<Property Name="RetailSettleDTO.SettleCustomer.Code"  Title="客户编码"/>
					<Property Name="RetailSettleDTO.SettleCustomer.Name"  Title="客户名称"/>
					<Property Name="RetailSettleDTO.SettleCustomer.IdpartnerClass"  Title="往来单位分类id"/>
					<Property Name="RetailSettleDTO.SettleCustomer.PartnerClass.ID"  Title="往来单位分类"/>
					<Property Name="RetailSettleDTO.SettleCustomer.PartnerClass.Name"  Title="往来单位名称"/>
					<Property Name="RetailSettleDTO.SettleCustomer.Iddistrict"  Title="地区id"/>
					<Property Name="RetailSettleDTO.SettleCustomer.District.ID"  Title="地区"/>
					<Property Name="RetailSettleDTO.SettleCustomer.District.Name"  Title="地区"/>
					<Property Name="RetailSettleDTO.SettleCustomer.District.Code"  Title="地区"/>
					<Property Name="RetailSettleDTO.idProject"  Title="项目ID"/>
					<Property Name="RetailSettleDTO.Project.ID"  Title="项目"/>
					<Property Name="RetailSettleDTO.Project.Name"  Title="项目名称"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc1"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc2"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc3"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc4"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc5"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefnvc6"  Title="单据专用字符自定义字符项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm1"  Title="单据公用字符自定义数值项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm2"  Title="单据公用字符自定义数值项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm3"  Title="单据公用字符自定义数值项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm4"  Title="单据公用字符自定义数值项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm5"  Title="单据公用字符自定义数值项"/>
					<Property Name="RetailSettleDTO.pubuserdefdecm6"  Title="单据公用字符自定义数值项"/>
				</Header>
				<Details>
					<Detail DetailRuleName="MutiSettleDetails" DTO="RetailMutiSettleDetailDTO" FK="idRetailSettleDTO" Title="现结明细">
						<Property Name="RetailMutiSettleDetailDTO.ID"  Title="ID"/>
						<Property Name="RetailMutiSettleDetailDTO.TS"  Title="TS"/>
						<Property Name="RetailMutiSettleDetailDTO.IdsettleStyle"  Title="结算方式id"/>
						<Property Name="RetailMutiSettleDetailDTO.SettleStyle.ID"  Title="结算方式"/>
						<Property Name="RetailMutiSettleDetailDTO.idBankAccount"  Title="账号id"/>
						<Property Name="RetailMutiSettleDetailDTO.BankAccount.ID"  Title="账号"/>
						<Property Name="RetailMutiSettleDetailDTO.BankAccount.BankNoType.ID"  Title="账号类型id"/>
						<Property Name="RetailMutiSettleDetailDTO.BankAccount.Idcurrency"  Title="账号币种id"/>
						<Property Name="RetailMutiSettleDetailDTO.BillNo"  Title="票据号"/>
						<Property Name="RetailMutiSettleDetailDTO.Amount"  Title="收款金额"/>
					</Detail>
					<Detail DetailRuleName="Details" DTO="RetailSettleDetailDTO" FK="IdRetailSettleDTO" Title="单据明细">
						<Property Name="RetailSettleDetailDTO.ID"  Title="ID"/>
						<Property Name="RetailSettleDetailDTO.TS"  Title="TS"/>
						<Property Name="RetailSettleDetailDTO.IdInventory"  Title="存货"/>
						<Property Name="RetailSettleDetailDTO.Inventory.ID"  Title="存货"/>
						<Property Name="RetailSettleDetailDTO.Inventory.Name"  Title="存货"/>
						<Property Name="RetailSettleDetailDTO.Inventory.Code"  Title="存货"/>
						<Property Name="RetailSettleDetailDTO.Inventory.IsLaborCost"  Title="存货"/>
						<Property Name="RetailSettleDetailDTO.Inventory.IdinventoryClass" Title="存货分类"/>
						<Property Name="RetailSettleDetailDTO.Inventory.InventoryClass.ID" Title="存货分类"/>
						<Property Name="RetailSettleDetailDTO.Inventory.InventoryClass.Code" Title="存货分类"/>
						<Property Name="RetailSettleDetailDTO.Inventory.InventoryClass.Name" Title="存货分类"/>
						<Property Name="RetailSettleDetailDTO.Inventory.priuserdefnvc1"  Title="存货字符自定义项"/>
						<Property Name="RetailSettleDetailDTO.Inventory.priuserdefnvc2"  Title="存货字符自定义项"/>
						<Property Name="RetailSettleDetailDTO.Inventory.priuserdefnvc3"  Title="存货字符自定义项"/>
						<Property Name="RetailSettleDetailDTO.Inventory.priuserdefnvc4"  Title="存货字符自定义项"/>
						<Property Name="RetailSettleDetailDTO.Inventory.priuserdefnvc5"  Title="存货字符自定义项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefnvc1"  Title="明细专用字符自定义字符项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefnvc2"  Title="明细专用字符自定义字符项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefnvc3"  Title="明细专用字符自定义字符项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefnvc4"  Title="明细专用字符自定义字符项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefdecm1"  Title="明细公用字符自定义数值项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefdecm2"  Title="明细公用字符自定义数值项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefdecm3"  Title="明细公用字符自定义数值项"/>
						<Property Name="RetailSettleDetailDTO.pubuserdefdecm4"  Title="明细公用字符自定义数值项"/>
						<Property Name="RetailSettleDetailDTO.TaxAmount"  Title="含税金额"/>
            <Property Name="RetailSettleDetailDTO.SettleTaxAmount"  Title="含税结算金额"/>
            <Property Name="RetailSettleDetailDTO.WipeChange"  Title="抹零"/>
						<Property Name="RetailSettleDetailDTO.SettleAmount"  Title="结算金额"/>
						<Property Name="RetailSettleDetailDTO.Price"  Title="原币单价"/>
						<Property Name="RetailSettleDetailDTO.SettleAmount"  Title="累计结算金额"/>
						<Property Name="RetailSettleDetailDTO.SettleTax"  Title="税额"/>
						<Property Name="RetailSettleDetailDTO.Quantity"  Title="数量"/>
					</Detail>
				</Details>
			</FullQuery>
			<TransactionDoc Type="Ufida.T.UA.RE.FC.DocGenRetailSettle">
				<SummaryFields>
					<Property Name="VoucherTypeId" Mapping="{IdvoucherType}" Title="单据类型ID"/>
          <Property Name="BusiTypeId" Mapping="IdbusinessType" Title="业务类型ID"/>
          <Property Name="BusiType" Mapping="BusinessType.Name" Title="业务类型"/>
					<Property Name="PartnerClass" Mapping="SettleCustomer.PartnerClass.Name" Title="往来单位"/>
					<Property Name="Partner" Mapping="SettleCustomer.Name" Title="往来单位"/>
					<Property Name="Department" Mapping="Store.Department.Name" Title="部门"/>
					<Property Name="Person" Mapping="Person.Name" Title="人员"/>
					<Property Name="Memo" Mapping="Memo" Title="备注"/>
				</SummaryFields>
				<!--借方开始-->
				<TransactionEntry Code="DebitFromAr" Name="应收账款" DCDirection="Debit">
					<Entry>
						<!--这段配置了没用处，需要倒挤，在代码里面算-->
						<Property Doc="OrigAmountDr" SourceVoucher="TaxAmount" Title="借方原币"/>
						<Property Doc="AmountDr" SourceVoucher="TaxAmount" Title="借方本币"/>
						<Property Doc="OrigAmount" SourceVoucher="TaxAmount" Title="外币"/>
						<Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>
						<Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
						<Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
						<!--这段配置了没用处，需要倒挤，在代码里面算-->
						<Account AccountRuleType="Ar">
							<ExtendRuleProperty Name="idpartnerclass" SourceVoucherProperty="RetailSettle.SettleCustomer.IdPartnerClass" Title="客户分类"/>
							<ExtendRuleProperty Name="idpartner" SourceVoucherProperty="RetailSettle.IdSettleCustomer" Title="客户"/>
							<ExtendRuleProperty Name="Iddistrict" SourceVoucherProperty="RetailSettle.SettleCustomer.Iddistrict" Title="地区"/>
							<ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="RetailSettle.Idcurrency" Title="币种"/>
							<ExtendRuleProperty Name="Idproject" SourceVoucherProperty="RetailSettle.Idproject" Title="项目"/>
							<ExtendRuleProperty Name="IdinventoryClass" SourceVoucherProperty="Inventory.IdinventoryClass" Title="存货分类"/>
							<ExtendRuleProperty Name="Idinventory" SourceVoucherProperty="Idinventory" Title="存货"/>
							<ExtendRuleProperty Name="IsLaborCost" SourceVoucherProperty="Inventory.IsLaborCost" Title="存货属性"/>
							<ExtendRuleProperty Name="IdprojectClass" SourceVoucherProperty="Project.IdClass" Title="项目分类"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>
						</Account>
					</Entry>
					<Auxiliary>
						<Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
						<Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
						<Property Doc="Idcurrency" SourceVoucher="F407692F-D14E-4A7F-84A4-87DF16406B5B"/><!--默认人民币-->
						<Property Doc="idbusiType" SourceVoucher="00000000-0000-0000-0000-000000000000"/>
						<Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
						<Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
						<Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
						<Property Doc="IdoutRdStyle" SourceVoucher="00000000-0000-0000-0000-000000000000"/>
						<Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
						<Property Doc="Idinventory" SourceVoucher="Idinventory"/>
						<Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
						<Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
						<Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
						<Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
					</Auxiliary>
					<SourceRelation>
						<Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
						<Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
						<Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
						<Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
					</SourceRelation>
				</TransactionEntry>
				<TransactionEntry Code="DebitFromCashOrBank" Name="现金、银行存款" DCDirection="Debit">
					<Entry>
						<Property Doc="OrigAmountDr" SourceVoucher="Amount" Title="借方原币"/>
						<Property Doc="AmountDr" SourceVoucher="Amount" Title="借方本币"/>
						<Property Doc="OrigAmount" SourceVoucher="Amount" Title="外币"/>
						<Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/><!--默认人民币-->
						<Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
						<Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
						<Property Doc="BillNo" SourceVoucher="BillNo" Title="票据号"/>
						<Account AccountRuleType="Cash">
							<!--现金-->
							<ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
							<ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="F407692F-D14E-4A7F-84A4-87DF16406B5B"/><!--默认人民币-->

							<ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.Iddepartment"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
							<!--<ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>-->
						</Account>
						<Account AccountRuleType="Bank">
							<!--银行存款-->
							<ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
							<ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="RetailSettle.Idcurrency"/>

							<ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.Iddepartment"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
							<!--<ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>-->
						</Account>
					</Entry>
					<Auxiliary>
						<Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
						<Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
            <Property Doc="Idcurrency" SourceVoucher="F407692F-D14E-4A7F-84A4-87DF16406B5B"/><!--默认人民币-->
            <Property Doc="idbusiType" SourceVoucher="00000000-0000-0000-0000-000000000000"/><!--不涉及到业务类型-->
						<Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
						<Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
						<Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
						<Property Doc="IdoutRdStyle" SourceVoucher="00000000-0000-0000-0000-000000000000"/><!--不涉及到-->
						<Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
						<Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
						<Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
						<Property Doc="IdsettleStyle" SourceVoucher="IdsettleStyle"/>
						<Property Doc="idBankAccount" SourceVoucher="IdbankAccount"/>
						<Property Doc="InvoiceCode" SourceVoucher="BillNo"/>
					</Auxiliary>
					<SourceRelation>
						<Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
						<Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
						<Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
						<Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
					</SourceRelation>
				</TransactionEntry>
        <TransactionEntry Code="DebitFromWipeChange" Name="抹零（现金折扣）" DCDirection="Debit">
          <Entry>
            <Property Doc="OrigAmountDr" SourceVoucher="WipeChange" Title="借方原币"/>
            <Property Doc="AmountDr" SourceVoucher="WipeChange" Title="借方本币"/>
            <Property Doc="OrigAmount" SourceVoucher="WipeChange" Title="外币"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>默认人民币无外币
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
            <Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
            <Account AccountRuleType="CashDiscount">
              <ExtendRuleProperty Name="IdinventoryClass" SourceVoucherProperty="Inventory.IdinventoryClass" Title="存货分类"/>
              <ExtendRuleProperty Name="Idinventory" SourceVoucherProperty="Idinventory" Title="存货"/>
              <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="RetailSettle.SettleCustomer.IdPartnerClass" Title="客户分类"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="RetailSettle.IdSettleCustomer" Title="客户"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.Iddepartment"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="RetailSettle.Idproject" Title="项目"/>

              <ExtendRuleProperty Name="IsLaborCost" SourceVoucherProperty="Inventory.IsLaborCost" Title="存货属性"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
              <ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
              <ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
            <Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
            <Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
            <Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
            <Property Doc="Idinventory" SourceVoucher="Idinventory"/>
            <Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
            <Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
            <Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
            <Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
            <Property Doc="Quantity" SourceVoucher="Quantity" Title="数量"/>
            <Property Doc="Price" SourceVoucher="Price" Title="单价"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
        <TransactionEntry Code="DebitFromVirtual" Name="零售项目" DCDirection="Debit">
          <Entry>
            <Property Doc="OrigAmountDr" SourceVoucher="Amount" Title="借方原币"/>
            <Property Doc="AmountDr" SourceVoucher="Amount" Title="借方本币"/>
            <Property Doc="OrigAmount" SourceVoucher="Amount" Title="外币"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>
            <!--默认人民币-->
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
            <Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
            <Property Doc="BillNo" SourceVoucher="BillNo" Title="票据号"/>
            <Account AccountRuleType="Bank">
              <!--现金-->
              <ExtendRuleProperty Name="IdbankAccount" SourceVoucherProperty="IdbankAccount"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="F407692F-D14E-4A7F-84A4-87DF16406B5B"/>
              <!--默认人民币-->

              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.Iddepartment"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
              <!--<ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>-->
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
            <Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
            <Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
            <Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
            <Property Doc="Idinventory" SourceVoucher="Idinventory"/>
            <Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
            <Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
            <Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
            <Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
            <Property Doc="Quantity" SourceVoucher="Quantity" Title="数量"/>
            <Property Doc="Price" SourceVoucher="Price" Title="单价"/>
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
            <Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
            <Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
          </SourceRelation>
        </TransactionEntry>
				<!--借方结束-->
				<!--贷方开始-->
				<TransactionEntry Code="DebitFromSales" Name="主营业务收入" DCDirection="Credit">
					<Entry>
						<Property Doc="AmountCr" SourceVoucher="SettleAmount" Title="贷方本币"/>
            <Property Doc="OrigAmountCr" SourceVoucher="SettleAmount" Title="贷方原币"/>
            <Property Doc="OrigAmount" SourceVoucher="SettleAmount" Title="外币" />
						<Property Doc="QuantityCr" SourceVoucher="Quantity" Title="贷方数量"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>默认人民币无外币
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
						<Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
						<Account AccountRuleType="Sales">
							<ExtendRuleProperty Name="IdinventoryClass" SourceVoucherProperty="Inventory.IdinventoryClass" Title="存货分类"/>
							<ExtendRuleProperty Name="Idinventory" SourceVoucherProperty="Idinventory" Title="存货"/>
							<ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="RetailSettle.SettleCustomer.IdPartnerClass" Title="客户分类"/>
							<ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="RetailSettle.IdSettleCustomer" Title="客户"/>
							<ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.Iddepartment"/>
							<ExtendRuleProperty Name="Idproject" SourceVoucherProperty="RetailSettle.Idproject" Title="项目"/>

							<ExtendRuleProperty Name="IsLaborCost" SourceVoucherProperty="Inventory.IsLaborCost" Title="存货属性"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
							<ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc0" SourceVoucherProperty="pubuserdefnvc1" Title="表体公共自定义字符项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc1" SourceVoucherProperty="pubuserdefnvc2" Title="表体公共自定义字符项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc2" SourceVoucherProperty="pubuserdefnvc3" Title="表体公共自定义字符项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefnvc3" SourceVoucherProperty="pubuserdefnvc4" Title="表体公共自定义字符项4"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm0" SourceVoucherProperty="pubuserdefdecm1" Title="表体公共自定义数值项1"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm1" SourceVoucherProperty="pubuserdefdecm2" Title="表体公共自定义数值项2"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm2" SourceVoucherProperty="pubuserdefdecm3" Title="表体公共自定义数值项3"/>
							<ExtendRuleProperty Name="Detailspubuserdefdecm3" SourceVoucherProperty="pubuserdefdecm4" Title="表体公共自定义数值项4"/>
						</Account>
					</Entry>
					<Auxiliary>
						<Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
						<Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
						<Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
						<Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
						<Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
						<Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
						<Property Doc="Idinventory" SourceVoucher="Idinventory"/>
						<Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
						<Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
						<Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
            <Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
						<Property Doc="Quantity" SourceVoucher="Quantity" Title="数量"/>
						<Property Doc="Price" SourceVoucher="Price" Title="单价"/>
					</Auxiliary>
					<SourceRelation>
						<Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
						<Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
						<Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
						<Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
					</SourceRelation>
				</TransactionEntry>
				<TransactionEntry Code="DebitFromSalesTax" Name="应交税金（销）"  DCDirection="Credit">
					<Entry>
            <Property Doc="OrigAmountCr" SourceVoucher="SettleTax" Title="贷方原币"/>
						<Property Doc="AmountCr" SourceVoucher="SettleTax" Title="贷方本币"/>
            <Property Doc="OrigAmount" SourceVoucher="SettleTax" Title="外币" />
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>默认人民币无外币
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
						<Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
						<Account AccountRuleType="SalesTax">
							<ExtendRuleProperty Name="IdinventoryClass" SourceVoucherProperty="Inventory.IdinventoryClass" Title="存货分类"/> 
                            <ExtendRuleProperty Name="Idinventory" SourceVoucherProperty="Idinventory" Title="存货"/> 
                            <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="RetailSettle.SettleCustomer.IdPartnerClass" Title="客户分类"/>
							<ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="RetailSettle.IdSettleCustomer" Title="客户"/>
						</Account>
					</Entry>
					<Auxiliary>
						<Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
						<Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
						<Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
						<Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
						<Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
						<Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
						<Property Doc="Idinventory" SourceVoucher="Idinventory"/>
						<Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
						<Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
						<Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
						<Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
					</Auxiliary>
					<SourceRelation>
						<Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
						<Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
						<Property Doc="SourceVoucherDetailId" SourceVoucher="ID"/>
						<Property Doc="SourceVoucherDetailTs" SourceVoucher="Ts"/>
					</SourceRelation>
				</TransactionEntry>
        <TransactionEntry Code="DebitFromAdv" Name="现结+使用预收>明细含税金额合计" DCDirection="Credit">
          <Entry>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>
            <!--默认人民币-->
            <Property Doc="ExchangeRate" SourceVoucher="ExchangeRate" Title="汇率"/>
            <Property Doc="Memoto" SourceVoucher="RetailSettle.Memo" Title="备注"/>
            <Account AccountRuleType="AdvReceive">
              <ExtendRuleProperty Name="IdpartnerClass" SourceVoucherProperty="RetailSettle.SettleCustomer.IdPartnerClass" Title="客户分类"/>
              <ExtendRuleProperty Name="idbusiType" SourceVoucherProperty="RetailSettle.IdbusinessType"/>
              <ExtendRuleProperty Name="Idpartner" SourceVoucherProperty="RetailSettle.IdSettleCustomer" Title="客户"/>
              <ExtendRuleProperty Name="Iddepartment" SourceVoucherProperty="RetailSettle.Store.idDepartment" Title="部门"/>
              <ExtendRuleProperty Name="IdClerk" SourceVoucherProperty="RetailSettle.idPerson"/>
              <ExtendRuleProperty Name="Iddistrict" SourceVoucherProperty="RetailSettle.SettleCustomer.Iddistrict"/>
              <ExtendRuleProperty Name="Idcurrency" SourceVoucherProperty="Idcurrency"/>
              <ExtendRuleProperty Name="Idproject" SourceVoucherProperty="RetailSettle.Idproject"/>
              <ExtendRuleProperty Name="IdprojectClass" SourceVoucherProperty="RetailSettle.Project.IdClass" Title="项目分类"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc0" SourceVoucherProperty="RetailSettle.pubuserdefnvc1" Title="表头公共自定义字符项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc1" SourceVoucherProperty="RetailSettle.pubuserdefnvc2" Title="表头公共自定义字符项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc2" SourceVoucherProperty="RetailSettle.pubuserdefnvc3" Title="表头公共自定义字符项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc3" SourceVoucherProperty="RetailSettle.pubuserdefnvc4" Title="表头公共自定义字符项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc4" SourceVoucherProperty="RetailSettle.pubuserdefnvc5" Title="表头公共自定义字符项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefnvc5" SourceVoucherProperty="RetailSettle.pubuserdefnvc6" Title="表头公共自定义字符项6"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm0" SourceVoucherProperty="RetailSettle.pubuserdefdecm1" Title="表头公共自定义数值项1"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm1" SourceVoucherProperty="RetailSettle.pubuserdefdecm2" Title="表头公共自定义数值项2"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm2" SourceVoucherProperty="RetailSettle.pubuserdefdecm3" Title="表头公共自定义数值项3"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm3" SourceVoucherProperty="RetailSettle.pubuserdefdecm4" Title="表头公共自定义数值项4"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm4" SourceVoucherProperty="RetailSettle.pubuserdefdecm5" Title="表头公共自定义数值项5"/>
              <ExtendRuleProperty Name="Headerpubuserdefdecm5" SourceVoucherProperty="RetailSettle.pubuserdefdecm6" Title="表头公共自定义数值项6"/>
              <!--不确定是否需要-->
              <ExtendRuleProperty Name="Headerpriuserdefnvc0" SourceVoucherProperty="RetailSettle.priuserdefnvc1"/>
              <ExtendRuleProperty Name="Headerpriuserdefnvc1" SourceVoucherProperty="RetailSettle.priuserdefnvc2"/>
              <ExtendRuleProperty Name="Headerpriuserdefnvc2" SourceVoucherProperty="RetailSettle.priuserdefnvc3"/>
              <ExtendRuleProperty Name="Headerpriuserdefnvc3" SourceVoucherProperty="RetailSettle.priuserdefnvc4"/>
              <ExtendRuleProperty Name="Headerpriuserdefnvc4" SourceVoucherProperty="RetailSettle.priuserdefnvc5"/>
              <ExtendRuleProperty Name="Headerpriuserdefnvc5" SourceVoucherProperty="RetailSettle.priuserdefnvc6"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm0" SourceVoucherProperty="RetailSettle.priuserdefdecm1"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm1" SourceVoucherProperty="RetailSettle.priuserdefdecm2"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm2" SourceVoucherProperty="RetailSettle.priuserdefdecm3"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm3" SourceVoucherProperty="RetailSettle.priuserdefdecm4"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm4" SourceVoucherProperty="RetailSettle.priuserdefdecm5"/>
              <ExtendRuleProperty Name="Headerpriuserdefdecm5" SourceVoucherProperty="RetailSettle.priuserdefdecm6"/>
              <!--不确定是否需要-->
            </Account>
          </Entry>
          <Auxiliary>
            <Property Doc="idBankAccount" SourceVoucher="IdbankAccount"/>
            <Property Doc="Idcustomer" SourceVoucher="RetailSettle.IdsettleCustomer"/>
            <Property Doc="IdcustomerClass" SourceVoucher="RetailSettle.SettleCustomer.IdpartnerClass"/>
            <Property Doc="Iddistrict" SourceVoucher="RetailSettle.SettleCustomer.Iddistrict"/>
            <Property Doc="Iddepartment" SourceVoucher="RetailSettle.Store.Iddepartment"/>
            <Property Doc="Idperson" SourceVoucher="RetailSettle.IdPerson"/>
            <Property Doc="Idcurrency" SourceVoucher="Idcurrency" Title="币种"/>
            <Property Doc="Idproject" SourceVoucher="RetailSettle.Idproject"/>
            <!--不涉及到业务类型-->
            <Property Doc="idbusiType" SourceVoucher="00000000-0000-0000-0000-000000000000"/>
            <Property Doc="VoucherCode" SourceVoucher="RetailSettle.Code"/>
            <Property Doc="VoucherDate" SourceVoucher="RetailSettle.VoucherDate"/>
            <Property Doc="IdvoucherType" SourceVoucher="{IdvoucherType}" Title="单据类型"/>
            <Property Doc="IdIncome" SourceVoucher=""/>
            <Property Doc="IdExpenseItem" SourceVoucher=""/>
            <Property Doc="IdWarehouse" SourceVoucher=""/>
            <Property Doc="Idinventory" SourceVoucher="Idinventory"/>           
            <Property Doc="IdUnit" SourceVoucher="IdUnit" Title="计量单位"/>
            <Property Doc="IdinventoryClass" SourceVoucher="Inventory.IdinventoryClass"/>
            <Property Doc="IdDocumentsUsageDTO" SourceVoucher=""/>
            <Property Doc="IdInRdStyle" SourceVoucher=""/>
            <!--<Property Doc="IdSettleStyle" SourceVoucher="IdsettleStyle"/>-->
            <!--<Property Doc="IdDistrict" SourceVoucher="Partner.iddistrict"/>-->
            <!--<Property Doc="IdBankAccount" SourceVoucher="IdbankAccount"/>-->
          </Auxiliary>
          <SourceRelation>
            <Property Doc="SourceVoucherId" SourceVoucher="RetailSettle.ID"/>
            <Property Doc="SourceVoucherTs" SourceVoucher="RetailSettle.Ts"/>
          </SourceRelation>
        </TransactionEntry>
				<!--贷方结束-->
			</TransactionDoc>
			<DocUpdateBack Title="回写" Type="Ufida.T.UA.RE.FC.DocUpdateBackRetailSettle" />
		</Voucher>
		</Modle>
</DocSourceVoucher>
